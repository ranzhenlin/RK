<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>数据库系统</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console", Consolas, "Courier", monospace; --title-bar-height: 20px ; }
.mac-os-11 { --title-bar-height: 28px ; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color) ; }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; color: rgb(0, 0, 0); }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; color: rgb(0, 0, 0); }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { color: rgb(0, 0, 0); break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; color: rgb(0, 0, 0); margin-bottom: -10px; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; color: rgb(0, 0, 0); }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; color: rgb(0, 0, 0); }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; color: rgb(0, 0, 0); }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace) ; }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace) ; }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace) ; }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none 0s ease 0s; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill) ; }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-require-zoom-fix foreignobject { font-size: var(--mermaid-font-zoom) ; }


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

 :root {--mermaid-font-zoom:1.25em ;} 
</style>
</head>
<body class='typora-export os-windows'>
<div id='write'  class=''><h3><a name="-数据库系统" class="md-header-anchor"></a><span>数据库系统</span></h3><h4><a name="1-数据库概述" class="md-header-anchor"></a><span>1 数据库概述</span></h4><h5><a name="1-1-数据库三阶段" class="md-header-anchor"></a><strong><span>1-1 数据库三阶段</span></strong></h5><p><span>	</span><span>人工管理阶段、文件管理阶段、数据库阶段</span></p><h5><a name="1-2-数据与数据库系统" class="md-header-anchor"></a><strong><span>1-2 数据与数据库系统</span></strong></h5><p><span>	</span><span>（1）数据库系统DBS（DBS=DB+DBMS+DBA）；</span>
<span>​</span><span>	</span><span>（2）数据库DB:是长期存储在计算机内、有组织、可共享的大量数据集合；</span>
<span>​</span><span>	</span><span>（3）数据库管理系统DBMS（核心）：</span>
<span>​</span><span>			</span><span>1）功能：①数据定义；②数据库操作；③数据库运行管理；④数据的组织存储管理；⑤数据库的建立与维护</span>
<span>​</span><span>			</span><span>2）特征：①数据结构化且统一管理；②有较高的数据独立性；③数据控制功能：数据库安全、数据完整性、并发控制、故障恢复</span>
<span>​</span><span>			</span><span>3）分类：①关系数据库；②面向对象数据库；③对象关系数据库；</span>
<span>​</span><span>	</span><span>（4）数据库管理员DBA</span></p><h5><a name="1-3-数据库体系架构" class="md-header-anchor"></a><strong><span>1-3 数据库体系架构</span></strong></h5><p><span>		</span><span>集中式数据库；客户端/服务器结构；客户端/服务器结构；客户端/服务器结构</span></p><h4><a name="2-数据库系统结构" class="md-header-anchor"></a><span>2 数据库系统结构</span></h4><h5><a name="2-1-数据模型" class="md-header-anchor"></a><strong><span>2-1 数据模型</span></strong></h5><p><span>（1）概念数据模型三要素：</span>
<span>			</span><span>数据结构(静态)；数据操作(动态)；完整性约束（实体完整性、参照完整性、自定义完整性）</span></p><p><span>（2）三级结构/两级映像：</span>
<span>		</span><mark><span>1）外模式（子模式、用户模式）：视图，局部、多个；</span></mark><span>外模式（子模式、用户模式）用以描述用户看到或使用的那部分数据的逻辑结构，用户根据外模式用数据操作语句或应用程序去操作数据库中的数据。外模式主要描述组成用户视图各个记录的组成、相互关系、数据项的特征、数据的安全性和完整性约束条件数据模型的分类外模式是数据库用户（包括程序员和最终用户）能够看见和使用的局部数据的逻辑结构和特征 的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。一个数据库可以有多个 外模式。一个应用程序只能使用一个外模式。</span></p><p><span>		</span><mark><span>2）外模式/模式映像：逻辑独立性；</span></mark><span>逻辑独立性是指用户的应用程序与数据库中的逻辑结构是相互独立的。当数 据的逻辑结构改变时，应用程序不需要改变。逻辑独立性存在于外模式和概念模式之间的映射转 换，说明概念模式发生变化时应用程序的独立程度</span></p><p><span>		</span><mark><span>3）模式（概念模式、逻辑模式）：全局、一个；</span></mark><span>概念模式（模式、逻辑模式）用以描述整个数据库中数据库的逻辑结构，描述现实世界中的实 体及其性质与联系，定义记录、数据项、数据的完整性约束条件及记录之间的联系是数据项值的框 架。概念模式通常还包含有访问控制、保密定义、完整性检查等方面的内容，以及概念/物理之间的映射。 概念模式是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。一个数据库只有一个概念模式，模式是数据库的中心与关键。</span></p><p><span>		</span><mark><span>4）模式/内模式映像：物理独立性；</span></mark><span>物理独立性是指用户的应用程序与存储在磁盘上的数据库中的数据是相互独 立的。当数据的物理存储改变时，应用程序不需要改变。物理独立性存在于概念模式和内模式之间 的映射转换，说明物理组织发生变化时应用程序的独立程度。</span></p><p><span>		</span><mark><span>5）内模式（存储模式、物理模式）：一个</span></mark><span>；内模式是数据物理结构和存储方式的描述，是数据在数据库内部的表示方式。一个数据库只有 一个内模式。</span></p><p><span>（3）数据模型分类：</span></p><p><span>		</span><span>1）数据模型主要有两大类，分别是概念数据模型（实体联系模型）和基本数据模型（结构数据模 型）。</span></p><p><span>		</span><span>2）基本数据模型：层次模型（树）、网状模型、关系模型（二维表）</span></p><p><span>		</span><span>3)  关系模型用表格结构（二维表）表达实体集，用外键表示实体间联系，其优点有： </span>
<span>​</span><span>			</span><span>①建立在严格的数学概念基础上; </span>
<span>​</span><span>			</span><span>②概念单一（关系），结构简单、清晰，用户易懂易用； </span>
<span>​</span><span>			</span><span>③存取路径对用户透明，从而数据独立性、安全性好，简化数据库开发工作。</span></p><h5><a name="2-2--概念模型e-r图" class="md-header-anchor"></a><strong><span>2-2  概念模型(E-R图)</span></strong></h5><h6><a name="2-2-1-三要素" class="md-header-anchor"></a><strong><span>2-2-1 三要素</span></strong></h6><p><span>		</span><span>（1）实体(型)：用矩形框表示，框内标注实体名称</span>
<span>​</span><span>		</span><span>（2）属性：用椭圆形表示，并用连线与实体连接起来，</span>
<span>​</span><span>				</span><span>1）派生属性：派生属性可以从其他属性得来；比如出生年月可以计算得出年龄，当出生年月属性已记录</span>
<span>​</span><span>				</span><span>2）简单属性和复合属性：单独属性是原子的、不可再分的，复合属性可以分解为更小的部分。一般对于复合属性会在题干中给出其分解特性，比如对于地址，可进—步划分为省、市、区，若不特别声明，通常指的是简单属性。</span>
<span>​</span><span>				</span><span>3）单值属性和多值属性：对于一个特定的实体都只有一个特定的值，则为单值属性：在某些特殊的情况下，—些属性可能对应一组值，这样的属性为多值属性。比如对于职工家属，可能有多名成员，会有一组取值，这里即为多值属性。</span>
<span>​</span><span>				</span><span>4）NULL属性：当实体在某个属性上没有特定值或属性值未知时，使用NULL值，表示无异议或不知道。</span></p><p><span>		</span></p><h6><a name="2-2-2--联系" class="md-header-anchor"></a><strong><span>2-2-2  联系</span></strong></h6><p><span>1:1  1:n  n:m；联系用菱形表示，通常菱形框内写明联系名，并用无向边分别与有关实体连接起来，同时在无向边旁标注上联系的类型(1:1  1:n  n:m)</span></p><p><span>（1）同一个实休集内的二元联系：</span>
<img src="%E5%9B%BE%E7%89%87/image-20210410161528115.png" alt="image-20210410161528115" style="zoom:67%;" /></p><p><span>（2）两个不同实体集之间联系：</span></p><p><img src="%E5%9B%BE%E7%89%87/image-20210410162437405.png" alt="image-20210410162437405" style="zoom:80%;" /><span>       </span><img src="%E5%9B%BE%E7%89%87/image-20210410162723040.png" alt="image-20210410162723040" style="zoom:80%;" /><span>        </span><img src="%E5%9B%BE%E7%89%87/image-20210410162750665.png" alt="image-20210410162750665" style="zoom:80%;" /></p><p><span>（3）两个以上不同实体集之间的联系（三元联系）多重度的确定</span>
<img src="%E5%9B%BE%E7%89%87/image-20210410162946635.png" alt="image-20210410162946635" style="zoom:85%;" /></p><p><span>	</span></p><h6><a name="2-2-3--实体转换e-r图转二维表）" class="md-header-anchor"></a><strong><span>2-2-3  实体转换（E-R图转二维表</span></strong><span>）</span></h6><p><span>			</span><span>1) 一个实体对应一个关系模式，实体的属性就是关系的属性，实体的码（关键字）就是关系的码；</span></p><p><span>			</span><span>2）1:1  码放入另一边中（任意）；一个1:1联系可以转换为一个独立的关系模式，也可以与任意一端对应的关系模式合并。 如果转换为一个独立的模式，则与该联系相连的各实体的码以及联系本身的属性均转换为关系的属 性，每个实体的码均是该关系的候选键。如果与某一端实体对应的关系模式合并，则需要在该关系 模式的属性中加入另一个关系模式的码和联系本身的属性。</span></p><p><span>			</span><span>3）1:n  1端的码放入n端；一个1:n联系可以转换为一个独立的关系模式，也可以与任意n端对应的关系模式合并。如 果转换为一个独立的模式，则与该联系相连的各实体的码以及联系本身的属性均转换为关系的属 性，而关系的码为n端实体的码。如果与n端实体对应的关系模式合并，则需要在该关系模式的属性 中加入1端关系模式的码和联系本身的属性。</span></p><p><span>			</span><span>4）n:m  单独转换，n m两端的码共同做主码，属性；一个n:m 联系转换为一个独立的关系模式，与该联系相连的各实体的码以及联系本身的属 性均转换为关系的属性，而关系的码为各实体码的组合。</span></p><p><span>			</span><span>5）三个以上实体间的一个多元联系可以转换为一个独立的关系模式，与该联系相连的各实体 的码以及联系本身的属性均转换为关系的属性，而关系的码为各实体码的组合。</span></p><p>&nbsp;</p><h6><a name="2-2-4-扩展的e-r模型" class="md-header-anchor"></a><strong><span>2-2-4 扩展的E-R模型</span></strong></h6><p><span>（1） 弱实体：在现实世界中有一种联系比较特殊，这种联系代表实体间的所有(Ownership)关系。这种实体对于另一些实体存在很强的依赖关系，即一个实体的存在必须以另一个实体为前提，将这类实体称为弱实体。比如附件是邮件的弱实体。弱实体一般以双矩形表示，与其依赖的实体之间存在联系：</span></p><p><img src="%E5%9B%BE%E7%89%87/image-20210410194028731.png" alt="image-20210410194028731" style="zoom:80%;" /></p><p><span>（2）特殊化：特殊化主要描述的是子类和父类之间的关系。子类是超类的特殊化，子类继承超类的所有属性和联系，并且还有自己特殊的属性和联系。比如经理是员工的特殊化。特殊化实体一般以双边矩形表示，与其超类以线圈的方式连接：</span></p><p><img src="%E5%9B%BE%E7%89%87/image-20210410170337078.png" alt="image-20210410170337078" style="zoom:80%;" /></p><p><span>（3）聚集：一个联系作为另一个联系的一端。</span></p><p><img src="%E5%9B%BE%E7%89%87/image-20210410170455205.png" alt="image-20210410170455205" style="zoom:80%;" /></p><h6><a name="2-2-5-注意" class="md-header-anchor"></a><strong><span>2-2-5 注意</span></strong></h6><p><span>		</span><span>1）多值属性的处理。如果E-R图中某实体具有一个多值属性，则应该进行优化，把该属性提 升为一个实体。或者在转化为关系模式时，将实体的码与多值属性单独构成一个关系模式。 </span>
<span>​</span><span>		</span><span>2）BLOB型属性的处理。典型的BLOB是一张图片或一个声音文件，由于它们的容量比较大， 必须使用特殊的方式来处理。处理BLOB的主要思想就是让文件处理器（如数据库管理器）不去理会 文件是什么，而是关心如何去处理它。因此，从优化的角度考虑，应采用的设计方案是将BLOB字段 与关系的码独立为一个关系模式。 </span>
<span>​</span><span>		</span><span>3）派生属性的处理。因为派生属性可由其他属性计算得到，因此，在转化成关系模式时，通常不转换派生属性。 </span>
<span>​</span><span>		</span><span>4）在对象-关系数据模型中，本章的&quot;关系模式&quot;就对应&quot;类&quot;,关系模式的属性就对应类的属性。</span></p><h6><a name="2-2-6-e-r图的集成" class="md-header-anchor"></a><strong><span>2-2-6 E-R图的集成</span></strong></h6><p><span>		</span><span>1）在数据库的概念结构设计过程中，先设计各子系统的局部E-R图，设计过程可分为以下几个步骤：</span>
<span>​</span><span>			</span><span>①确定局部视图的范围；</span>
<span>​</span><span>			</span><span>② 识别实体及其标识；</span>
<span>​</span><span>			</span><span>③ 确定实体间的联系； </span>
<span>​</span><span>			</span><span>④分配实体及联系的属性</span></p><p><span>		</span><span>2）各局部E-R图之间的冲突主要有三类：</span>
<span> </span><span>			</span><span>①属性冲突：包括属性域冲突和属性取值冲突。属性冲突理论上好解决，只要换成相同的属 性就可以了，但实际上需要各部门协商，解决起来并不简单。</span>
<span>​</span><span>			</span><span> ② 命名冲突：包括同名异义和异名同义。处理命名冲突通常也像处理属性冲突一样，通过讨 论和协商等行政手段加以解决。</span>
<span>​</span><span>			</span><span> ③结构冲突：包括同一对象在不同应用中具有不同的抽象，以及同一实体在不同局部E-R图 中所包含的属性个数和属性排列次序不完全相同。</span></p><h4><a name="3-关系代数运算" class="md-header-anchor"></a><span>3 关系代数运算</span></h4><h6><a name="3-1关系数据模型" class="md-header-anchor"></a><strong><span>3-1关系数据模型</span></strong></h6><p><span>3-1-1  关系-动态；关系模式-静态</span></p><p><span>3-1-2  基本概念：</span>
<span>	</span><span>（1）候选码：唯一能确定一条记录的属性或属性组</span>
<span>	</span><span>（2）主码：从众多候选码挑选一个作为主码</span>
<span>	</span><span>（3）主属性：包含在众多候选码中的属性</span>
<span>	</span><span>（4）非主属性，不包含在候选码中的诸属性</span>
<span>	</span><span>（5）外码：在关系中该属性（组）不是主码，但他是其他关系的码，对该关系而言该属性（组）就是外码</span>
<span>	</span><span>（6）全码：关系模型中所有的属性组就是该关系模式的候选码</span></p><h6><a name="3-2-关系代数及运算" class="md-header-anchor"></a><strong><span>3-2 关系代数及运算</span></strong></h6><p><span>3-2-1 关系代数基本概念：</span>
<span>	</span><span>（1）广义笛卡尔积（R×S）：列相加，行相乘</span>
<span>	</span><span>（2）并（R∪S）：相同元组写一次，不同元组全写</span>
<span>	</span><span>（3）差（R－S）：去掉R中与S相同的元组</span>
<span>	</span><span>（4）交（R∩S）：取两表相同的元组</span>
<span>	</span><span>（5）除（R÷S）:  R中包含S的所有属性的字段</span></p><p><span>3-2-1 关系代数基本概念：</span>
<span>	</span><span>（1）选择（σF(A)）:选择满足条件的元组</span>
<span>	</span><span>（2）投影（πF(A)）:满足条件的列</span>
<span>	</span><span>（3）连接：从两个关系的笛卡儿积中选取属性间满足一定条件的元组</span>
<span>			</span><span>1）等值连接：从R与S关系的广义笛卡儿积中选取A、B属性值相等的那些元素：</span><span>		</span>
<span>			</span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.708ex" height="3.861ex" viewBox="0 -806.1 9777 1662.6" role="img" focusable="false" style="vertical-align: -1.989ex;"><defs><path stroke-width="0" id="E1-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E1-MJMAIN-221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path><path stroke-width="0" id="E1-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E1-MJMATHI-3B8" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path><path stroke-width="0" id="E1-MJMATHI-42" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path stroke-width="0" id="E1-MJMATHI-53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path stroke-width="0" id="E1-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E1-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path><path stroke-width="0" id="E1-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E1-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path stroke-width="0" id="E1-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E1-MJMATHI-52" x="0" y="0"></use><g transform="translate(759,0)"><use xlink:href="#E1-MJMAIN-221E" x="199" y="0"></use><g transform="translate(0,-684)"><use transform="scale(0.707)" xlink:href="#E1-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E1-MJMATHI-3B8" x="750" y="0"></use><use transform="scale(0.707)" xlink:href="#E1-MJMATHI-42" x="1219" y="0"></use></g></g><use xlink:href="#E1-MJMATHI-53" x="2324" y="0"></use><use xlink:href="#E1-MJMAIN-3D" x="3247" y="0"></use><g transform="translate(4302,0)"><use xlink:href="#E1-MJMATHI-3C3" x="0" y="0"></use><g transform="translate(571,-162)"><use transform="scale(0.707)" xlink:href="#E1-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E1-MJMATHI-3B8" x="750" y="0"></use><use transform="scale(0.707)" xlink:href="#E1-MJMATHI-42" x="1219" y="0"></use></g></g><use xlink:href="#E1-MJMAIN-28" x="6372" y="0"></use><use xlink:href="#E1-MJMATHI-52" x="6761" y="0"></use><use xlink:href="#E1-MJMAIN-D7" x="7742" y="0"></use><use xlink:href="#E1-MJMATHI-53" x="8742" y="0"></use><use xlink:href="#E1-MJMAIN-29" x="9387" y="0"></use></g></svg></span><script type="math/tex">R\underset{A\theta B}{\mathop{\infty }}\,S={{\sigma }_{A\theta B}}(R\times S)</script><span>或 </span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.723ex" height="3.861ex" viewBox="0 -806.1 10214 1662.6" role="img" focusable="false" style="vertical-align: -1.989ex;"><defs><path stroke-width="0" id="E2-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E2-MJMAIN-221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path><path stroke-width="0" id="E2-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E2-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E2-MJMATHI-42" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path stroke-width="0" id="E2-MJMATHI-53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path stroke-width="0" id="E2-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path><path stroke-width="0" id="E2-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E2-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path stroke-width="0" id="E2-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E2-MJMATHI-52" x="0" y="0"></use><g transform="translate(759,0)"><use xlink:href="#E2-MJMAIN-221E" x="308" y="0"></use><g transform="translate(0,-684)"><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMAIN-3D" x="750" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-42" x="1528" y="0"></use></g></g><use xlink:href="#E2-MJMATHI-53" x="2542" y="0"></use><use xlink:href="#E2-MJMAIN-3D" x="3465" y="0"></use><g transform="translate(4521,0)"><use xlink:href="#E2-MJMATHI-3C3" x="0" y="0"></use><g transform="translate(571,-162)"><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMAIN-3D" x="750" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-42" x="1528" y="0"></use></g></g><use xlink:href="#E2-MJMAIN-28" x="6809" y="0"></use><use xlink:href="#E2-MJMATHI-52" x="7198" y="0"></use><use xlink:href="#E2-MJMAIN-D7" x="8179" y="0"></use><use xlink:href="#E2-MJMATHI-53" x="9179" y="0"></use><use xlink:href="#E2-MJMAIN-29" x="9824" y="0"></use></g></svg></span><script type="math/tex">R\underset{A=B}{\mathop{\infty }}\,S={{\sigma }_{A=B}}(R\times S)</script>
<span>			</span><span>2）自然连接：自然连接是特殊的等值连接，它要求两个两个关系总进行比较的分量必须是相同的属性组，并且要在结果中把重复的属性去掉： </span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.537ex" height="2.928ex" viewBox="0 -806.1 12717.2 1260.5" role="img" focusable="false" style="vertical-align: -1.055ex;"><defs><path stroke-width="0" id="E3-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E3-MJMAIN-221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path><path stroke-width="0" id="E3-MJMATHI-53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path stroke-width="0" id="E3-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E3-MJMATHI-3C0" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path><path stroke-width="0" id="E3-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E3-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path><path stroke-width="0" id="E3-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E3-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E3-MJMATHI-42" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path stroke-width="0" id="E3-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E3-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E3-MJMATHI-52" x="0" y="0"></use><use xlink:href="#E3-MJMAIN-221E" x="759" y="0"></use><use xlink:href="#E3-MJMATHI-53" x="1759" y="0"></use><use xlink:href="#E3-MJMAIN-3D" x="2681" y="0"></use><use xlink:href="#E3-MJMATHI-3C0" x="3737" y="0"></use><use xlink:href="#E3-MJMAIN-28" x="4310" y="0"></use><g transform="translate(4699,0)"><use xlink:href="#E3-MJMATHI-3C3" x="0" y="0"></use><g transform="translate(571,-186)"><use transform="scale(0.707)" xlink:href="#E3-MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMATHI-53" x="389" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMAIN-2E" x="1034" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMATHI-41" x="1312" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMAIN-3D" x="2062" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMATHI-52" x="2840" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMAIN-2E" x="3599" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMATHI-42" x="3877" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMAIN-29" x="4636" y="0"></use></g></g><use xlink:href="#E3-MJMAIN-29" x="8923" y="0"></use><use xlink:href="#E3-MJMAIN-28" x="9312" y="0"></use><use xlink:href="#E3-MJMATHI-52" x="9701" y="0"></use><use xlink:href="#E3-MJMAIN-D7" x="10682" y="0"></use><use xlink:href="#E3-MJMATHI-53" x="11683" y="0"></use><use xlink:href="#E3-MJMAIN-29" x="12328" y="0"></use></g></svg></span><script type="math/tex">R\infty S=\pi ({{\sigma }_{(S.A=R.B)}})(R\times S)</script>
<span>注意：一般的连接是从行的角度进行运算，但是自然连接还需要去掉重复列，所以同时从行列的角度进行运算。</span></p><p><span>	</span><span>（4）外连接：两个关系R和S进行自然连接时，选择两个关系R和S公共属性相等的元组，去掉重复的属性列构成新关系</span>
<span>​</span><span>			</span><span>1）左外连接：R和S进行自然连接时，只把R中舍弃的元组放到新关系中</span>
<span>​</span><span>			</span><span>2）右外连接：R和S进行自然连接时，只把S中舍弃的元组放到新关系中</span>
<span>​</span><span>			</span><span>3）完全外连接：R和S进行自然连接时，只把R和S中舍弃的元组都放到新关系中</span></p><h4><a name="4-规范化理论" class="md-header-anchor"></a><span>4 规范化理论</span></h4><h6><a name="4-1-函数依赖" class="md-header-anchor"></a><strong><span>4-1 函数依赖</span></strong></h6><p><span>（1）部分函数依赖：若AB属性组为关系R的主码，主属性A可以确定非主属性C，则称C部分函数依赖于A。</span>
<span>（2）传递函数依赖：若A属性为关系R的主码，主属性A可以确定非主属性B及C，且非主属性也可以确定非主属性C，则称C传递函数依赖于A。</span>
<span>（3）数据冗余是一定存在的，只能尽量减少不必要的数据冗余，数据冗余是不能完全消除的。</span></p><h6><a name="4-2--范式" class="md-header-anchor"></a><strong><span>4-2  范式</span></strong></h6><p><span>4-2-1 概念：设计数据库中的关系模式必须遵守一定的规则，这种规则就称为范式</span></p><p><span>4-2-2 六大范式:</span>
<span>（1）第一范式：基本的二维表，列不可再分，不存在表中表，即存在部分函数依赖或者传递函数依赖</span>
<span>（2）第二范式：每个非主属性完全依赖于任意一个候选码，即不存在部分函数依赖</span>
<span>（3）第三范式：在第二范式的基础上，不存在传递函数依赖</span>
<span>（4）BC范式：在第三范式的基础上，消除主属性对码的部分和传递函数依赖，即BC方式消除了任何数属性（主属性和分主属性）都码部分函数依赖和传递函数依赖</span></p><p><span>4-2-3 常见的范式判断：</span>
<span>（1）单属性主码一定达到第二范式</span>
<span>（2）任何一个包含两个属性的关系模式一定满足 3NF</span>
<span>（3）任何一包含两个属性的关系模式一定满足 BCNF</span>
<span>（4）一个全码的关系模式最高一定可以达到3NF</span></p><h6><a name="4-3--范式分解" class="md-header-anchor"></a><strong><span>4-3  范式分解</span></strong></h6><p><span>（1）通常采用图表法</span></p><h4><a name="5-sql语言" class="md-header-anchor"></a><span>5 SQL语言</span></h4><h5><a name="5-1-数据定义" class="md-header-anchor"></a><strong><span>5-1 数据定义</span></strong></h5><p><strong><span>5-1-1 定义数据库</span></strong>
<span>（1）CREATE DATABASE &lt;数据库名&gt;</span>
<span>		</span><span> ON （name=“名称”</span><span>		</span><span>filename=“d:/路径.mdf”</span><span>		</span><span>size=“5MB”</span><span>		</span><span>maxsize=“20MB” </span><span>		</span><span>filegrowth=“20MB”）;</span>
<span>例 ：创建一个名为P_S_J，及其日志文件</span>
<code>create database P_S_J
	ON(name=&quot;P_S_J&quot;,
	filename=&quot;E:\201858344038冉贞林\实验一\数据库\P_S_J.mdf&quot;,
	size=5MB,
	maxsize=50MB,
	filegrowth=10%
	)
	log ON(name=&quot;P_S_J_log&quot;,
	filename=&quot;E:\201858344038冉贞林\实验一\数据库\P_S_J_log.ldf&quot;,
	size=2MB,
	maxsize=6MB,
	filegrowth=1MB
	);</code></p><p>&nbsp;</p><p><strong><span>5-1-2 定义基本表</span></strong></p><p><span>（1）语法：CREATE TABLE &lt;表名&gt; </span>
<span>（&lt;列名&gt;</span><span>	</span><span>&lt;数据类型&gt; </span><span>	</span><span>[列级完整性约束条件] </span><span>	</span><span>[表级完整性约束条件]）;</span>
<span>（2）完整性约束：①定义主键子句：primary key</span><span>	</span><span>&lt;属性名&gt;；②检查子句：check(&lt;条件&gt;)；</span>
<span>	</span><span>③外键子句：constraint &lt;约束名（外键取名）&gt; </span><span>	</span><span>foreign key&lt;副表属性名&gt; </span><span>	</span><span>references </span><span>	</span><span>&lt;主表属性名&gt;；</span>
<span>例1：在数皆库P_S_J中，创建一张S的表：</span>
<code>use P_S_J;
create table S
(SNO CHAR(4) PRIMARY KEY,
SNAME VARCHAR(20),
SADDR VARCHAR(30) 
);</code></p><p><span>例2：创建一张计教师授课表TC，定义TNO和CNO是外键同时又是该表的主键，教不为空，并且year大于1</span>
<code>create table TC
(TNO CHAR(4) NOT NULL,
CNO CHAR(4) NOT NULL,</code>
<code>YEAR INT NOT NULL CHECK (YEAR&gt;1),</code>
<code>primary key (TNO,CNO),</code>
<code>contraint TC_T foreign key(TNO) references T(TNO),</code>
<code>contraint TC_C foreign key(CNO) references T(CNO))</code></p><p><strong><span>5-1-3 修改基本表结构</span></strong>
<span>（1）添加属性</span>
<span>	</span><span>1）语法：ALTER </span><span>	</span><span>TABLE&lt;基本表名&gt;</span><span>	</span><span>ADD&lt;新属性名&gt; &lt;新属性类型&gt;</span>
<span>	</span><span>新增属性能不能设置为NOT NULL</span>
<span>	</span><span>2）例：在基本表T中添加一条联系电话属性（TELE）；</span>
<span>	</span><code>ALTER TABLE T ADD TELE CHAR(13)</code></p><p><span>（2）修改原属性的数据类型</span>
<span>	</span><span>1）语法：ALTER TABLE&lt;基本表名&gt; ALTER COLUMN &lt;新属性名&gt; &lt;新属性类型&gt;</span>
<span>	</span><span>2）例：将表T中年龄的数据类型改为SMALLINT</span>
<span>	</span><code>ALTER TABLE T ALTER  COLUMN YEAR SMALLINT</code></p><p><span>（3）删除原有属性</span>
<span>	</span><span>1）语法：ALTER TABLE&lt;基本表名&gt; DROP COLUMN &lt;属性名&gt;</span>
<span>	</span><span>2）例：将表T中TELE属性删除</span>
<span>		</span><code>ALTER TABLE T DROP COLUMN TELE</code></p><p><span>（4）禁止参照完整约束</span>
<span>	</span><span>1）语法：ALTER TABLE&lt;基本表名&gt;  NOCHECK CONSTRAINT &lt;约束名&gt;</span>
<span>	</span><span>2）例：禁止TC表参照完整性约束TC_T</span>
<span>	</span><code>ALTER TABLE TC  NOCHECK CONSTRAINT TC_T</code></p><p><span>（5）修改列名</span>
<span>	</span><span>1）语法：EXEC SP_RENAME  ’表名.列名‘， ’表名.新列名‘</span>
<span>	</span><span>2）例：修改T表中字段名NAME，为T_NAME</span>
<span>	</span><code>EXEC SP_RENAME  ’T.NAME‘， ’T.T_NAME‘</code></p><p><span>（6）修改表名</span>
<span>	</span><span>1）语法：EXEC SP_RENAME  ’原表名‘，’新表名‘</span>
<span>	</span><span>2）例：修改T表表名改为T_T</span>
<span>	</span><code>EXEC SP_RENAME  ’T‘，’T_T‘</code></p><p><strong><span>5-1-3 删除基本表</span></strong></p><p><span>（1）语法：DROP TABLE &lt;基本表名&gt;</span>
<span>（2）例：删除表T</span>
<span>		</span><code>DROP TABLE T</code></p><p><strong><span>5-1-4 索引的建立与删除</span></strong></p><p><span>（1）概念：数据库中索引是为了加速对表中纪录的检索而创建的一种分散存储结构，它实际是纪录的关键字与其相应地址的对应表。索引是对表和视图而建立的。</span></p><p><span>（2）建立索引</span>
<span>	</span><span>1）语法：CREATE [UNIQUE | CLUSTERED | UNCLUSTERED] INDEX &lt;索引名&gt; ON {&lt;表名&gt; | &lt;视图名&gt;} {&lt;列名&gt; [ ASC| DESC]}</span>
<span>	</span><span>说明：UNIQUE 唯一索引，CLUSTERED 聚类索引，UNCLUSTERED 非聚类索引；经常更新的字段不适合建索引</span>
<span>	</span><span>2）例：为teacher数据库中的T、C、TC三个表建立索引，其中，T表按教师编号升序建立唯一索引，C表按课程号降序建立聚类索引，TC表按照教师编号升序和课程号降序建立非聚类索引；</span>
<code>CREATE UNIQUE INDEX T_TNO ON T(TNO);</code>
<code>CREATE CLUSTERED	INDEX C_CNO ON C(CNO DESC);</code>
<code>CREATE UNCLUSTERED	INDEX  TC_TNO_CNO ON TC(TNO ASC,CNO DESC);</code></p><p><span>（2）删除索引</span>
<span>	</span><span>1）语法：DROP INDEX 表名.&lt;索引名&gt;|视图名.&lt;索引名&gt;</span>
<span>	</span><span>2）例：删除表TC中的TC_TNO_CNO的索引；</span>
<code>DROP INDEX TC.TC_TNO_CNO</code></p><h5><a name="5-2-数据查询" class="md-header-anchor"></a><strong><span>5-2 数据查询</span></strong></h5><h6><a name="5-2-1-基本语法" class="md-header-anchor"></a><span>5-2-1 基本语法</span></h6><p><span>（1）基本语法：</span>
<span>SELECT [ALL | DISTINCT] &lt;目标列表达式&gt;[,&lt;目标列表达式&gt;]… </span>
<span>FROM &lt;表或视图名&gt;[,&lt;表或视图名&gt;]… </span>
<span>[WHERE &lt;条件表达式&gt;] [GROUP BY &lt;列名1&gt; [HAVING &lt;条件表达式&gt;]]</span>
<span>[ORDER BY &lt;列名2&gt; [ASC|DESC]]；</span></p><p><span>（2）执行顺序：</span>
<span>①from:源数据→②where:筛选条件→③group by:分组条件→④having:分组的筛选条件→⑤select:查询→⑥order by排序</span></p><h6><a name="5-2-2-单表查询" class="md-header-anchor"></a><strong><span>5-2-2 单表查询</span></strong></h6><p><span>5-2-2-1 指定列或表达式的查询</span>
<span>例1：查询全体教师信息</span>
<code>select * from teacher</code></p><p><span>例2：查询开设全部课程的名称及性质</span>
<code>select cn,cx from course</code></p><p><span>例3：查询全体老师的姓名，性别及出生年份</span>
<code>select tname,sex,’出生年份：’,2021-age from T</code></p><p><span>5-2-2-2 消除重复行的查询</span>
<span>例1：查询担任课程的教师</span>
<code>select distinct TNO from TC</code></p><p><span>5-2-2-3 条件子查询</span></p><figure><table><thead><tr><th><span>查询条件</span></th><th><span>谓词</span></th></tr></thead><tbody><tr><td><span>比较运算符</span></td><td><span>=，＜，&gt;，＜＝，＞＝，!＝，&lt;&gt;，!＞，!＜（可与not连用）</span></td></tr><tr><td><span>确定范围</span></td><td><span>BETWEEN    AND（闭区间），NOT BETWEEN  AND</span></td></tr><tr><td><span>确定集合</span></td><td><span>IN,NOT IN</span></td></tr><tr><td><span>字符匹配</span></td><td><span>LIKE,NOT LIKE</span></td></tr><tr><td><span>空值</span></td><td><span>IS NULL,IS NOT NULL</span></td></tr><tr><td><span>多重条件</span></td><td><span>AND,OR ,NOT</span></td></tr></tbody></table></figure><p><span>（1）使用比较运算符</span>
<span>例1：查询职称为讲师的教师编号，姓名，性别和专业</span>
<code>select TNO,TN,SEX,DEPT from T where ZC=‘讲师’</code></p><p><span>（2）确定范围</span>
<span>例1：查询开设课程的学分为2-3分的课程名称和学分</span>
<code>select CN,CT,from C where CT BETWEEN 2 AND 3</code><span> 等价于</span><code>select CN,CT,from C where CT &gt;=2 and CT&lt;=3</code>
<span>例2：查询开设课程的学分不为2-3分的课程名称和学分</span>
<code>select CN,CT,from C where CT NOT BETWEEN 2 AND 3</code><span> 等价于</span><code>select CN,CT,from C where CT &gt;=3 and CT&lt;=2</code></p><p><span>（3）确定集合</span>
<span>例1：查询计算机和软件工程专业的教师编号、姓名、性别；</span>
<code>select TNO,TN,SEX from where DEPT IN(‘计算机’,’软件工程‘)</code>
<span>等价于</span><code>select TNO,TN,SEX from where DEPT=‘计算机’or DEPT=’软件工程‘)</code><span> </span></p><p><span>（4）字符匹配（模糊查询）</span>
<span>	</span><span>1）语法：字段名 [NOT]  LIKE &lt;匹配串&gt; [ESCAPE &lt;换码字符&gt;]</span>
<span>	</span><span>2）常见通配符：</span></p><figure><table><thead><tr><th><span>通配符</span></th><th><span>描述</span></th></tr></thead><tbody><tr><td><span>%</span></td><td><span>代表0个或多个任意字符串</span></td></tr><tr><td><span>_</span></td><td><span>代表任单个字符</span></td></tr><tr><td><span>[]</span></td><td><span>指定范围（[a-z]）或集合（[abcd]）中的任何单个字符</span></td></tr><tr><td><span>[^]</span></td><td><span>不属于指定范围（[a-z]）或集合（[abcd]）中的任何单个字符</span></td></tr></tbody></table></figure><p><span>例1：查询姓王的老师情况</span>
<code>select * from where TN like ‘王%’</code><span> </span></p><p><span>例2：查询第二个字为“成”的老师的情况</span>
<code>select * from where TN like ‘_成%’</code><span> </span></p><p><span>3）换码字符的使用</span>
<span>例1：查询DB_Design课程的情况</span>
<code>select * from C where CN LIKE ’DB \ _Design‘ ESCAPE ’\‘</code><span> </span>
<span>含义： ESCAPE ’\‘ 短语表示为转义字符，这样在匹配串中紧跟在’\‘ 后面的字符不在具有通配符的含义，而是匹配串本身的含义</span></p><p><span>4）有关空值的查询</span>
<span>例1:查询还没有填写课程教龄的教师编号和课程编号:</span>
<code>select TNO,CNO from TC where YEAR IS NULL</code></p><p><span>5）统计函数的使用</span></p><figure><table><thead><tr><th><span>函数名称</span></th><th><span>功能</span></th></tr></thead><tbody><tr><td><span>COUNT(列名 </span><span>|</span><span> *)</span></td><td><span>统计满足条件行数</span></td></tr><tr><td><span>SUM()</span></td><td><span>求和函数，空值会被忽略</span></td></tr><tr><td><span>AVG()</span></td><td><span>求平均值</span></td></tr><tr><td><span>MAX()</span></td><td><span>求最大值</span></td></tr><tr><td><span>MIN()</span></td><td><span>求最小值</span></td></tr></tbody></table></figure><p><span>例1：统计上过C2课程的老师人数</span>
<code>select count(*)人数 from TC where CNO=‘C2’</code>
<span>例2：查询担任所有上课任务的教师编号</span>
<code>select count(distinct TNO) from TC</code>
<span>例3：统计开设专业课的门数，以及这些课程的最高分，最低分，和平均分</span>
<code>select count( *)门数，MAX(CT)最低分，MIN(CT)最高分，AVG(CT)平均分 from C where CX=“专业基础”</code></p><p><span>（5） 分组查询</span></p><p><span>1）group by子句可以将查询结果表的各行按照一列或多列取值相等的原则进行分组。</span>
<span>例1：查询各课程号和担任该课程的教师人数</span>
<code>select CNO,COUNT(TNO) from TC group by CNO</code></p><p><span>2）用having短语指定条件，对分组后的结果进行筛选，</span>
<span>having与where的区别：having对分组后的结果进行筛选，where是对查询表内所有内容设定条件</span></p><p><span>例2：查询有三个教师以上（含三个）担任同一门课程的课程号和担任教师数</span>
<code>select CNO,COUNT(TNO) from TC group by CNO having COUNT(*)&gt;=3</code></p><p><span>（6）排序</span>
<span>	</span><span>1）用order by对查询结果按一个或多个字段进行排序</span>
<span>	</span><span>2）ASC升序，DESC降序，默认为升序</span>
<span>例1：查询法人担任C2课程的教师编号和担任该课程的教龄，查询结果按照教龄有大到小做降序排列</span>
<code>select TNO,YEAR from TC where CNO=‘C2’ order by YEAR DESC</code></p><h6><a name="5-2-3-多表查询" class="md-header-anchor"></a><span>5-2-3 多表查询</span></h6><p><span>例1：查询担任课程名为数据结构的教师编号和姓名</span>
<code>select T.TNO,TN,from T,TC,C where T.TNO=TC.TNO AND TC.CNO=C.CNO AND CN=‘数据结构’</code></p><p>&nbsp;</p><h5><a name="5-3-数据插入更新删除" class="md-header-anchor"></a><span>5-3 数据插入更新删除</span></h5><h6><a name="5-3-1-数据插入" class="md-header-anchor"></a><span>5-3-1 数据插入</span></h6><p><span>（1）单条插入记录</span>
<span>	</span><span>1）语法：INSERT INTO &lt;表名&gt; [(属性列1| 属性列2……)] VALUES (&lt;常量1&gt;……)</span>
<span>	</span><span>例1：向T表中插入一条记录 姓名：曹庆，性别：男，年龄：22，家庭住址：重庆奉节</span>
<span>		</span><code>insert into T (姓名，性别，年龄，家庭住址) values  (‘曹庆’，‘男’，22，‘重庆奉节’)</code></p><p><span>（2）插入子查询结果</span>
<span>	</span><span>例1：求T表中各专业教师的平均年龄，并将查询结果保存到数据库中</span>
<span>		</span><span>要将操作结果保存到数据库找中，必须要建立一张数据表（DEPTAGE）,其中有两个属性，分别为专业（DEPT）,和平均年龄（AVGAGE）,然后将查询结果保存的表中</span>
<code>create table DEPTAGE(DEPT CHAR(10),AVGAGE TINYINT)</code>
<code>insert into DEPTAGE (DEPT ,AVGAGE )</code>
<code>select DEPT AVG(AGE) from  T  GROUP BY DEPT</code>
<code>select * from DEPTAGE</code><span> </span></p><p>&nbsp;</p><h6><a name="5-3-2-数据修改" class="md-header-anchor"></a><span>5-3-2 数据修改</span></h6><p><span>（1）修改单条记录</span>
<span>1）语法：UPDATE &lt;表名&gt;  SET &lt;列名&gt;=&lt;表达式&gt; [&lt;列名&gt;=&lt;表达式&gt;]…… [where &lt;条件&gt;]</span>
<span>where子句省略，则修改表中所有记录</span>
<span>2）例1：对T表中每一位教师年龄增加1岁，并将编号为“S2”的教师职称改为“副教授”</span>
<code>update T set AGE=AGE+1</code>
<code>update T set ZC=‘副教授’ where TNO=‘S2’</code><span> </span></p><p><span>（2）带子查询的修改语句</span>
<span>1）将子查询嵌套在更新语句中，用来作为修改操作的条件</span>
<span>2）例1：将信息技术专业的全体教师授课的教龄均改为5年</span>
<code>update TC set YEAR=5  where ‘信息技术’=（select DEPT from T where TC.TNO=T.TNO）</code></p><p>&nbsp;</p><h6><a name="5-3-3-数据删除" class="md-header-anchor"></a><span>5-3-3 数据删除</span></h6><p><span>（1）删除单表数据</span>
<span>1）语法：DELETE FROM &lt;表名&gt; [where&lt;条件&gt;]</span>
<span>where子句缺省，则删除表中的所有记录，但是表结构还在</span>
<span>2）例1：删除TC表中关于计算机专业的记录</span>
<code>DELETE FROM TC where DEPT=‘计算机’</code></p><p><span>（2）带有子查询的删除语句</span>
<span>例2：删除信息技术专业中所有教师的授课记录</span>
<code>delete from TC where ‘信息技术’=（select DEPT from T where T.TNO=TC.TNO）</code></p><p>&nbsp;</p><h5><a name="5-4-视图的建立更新删除" class="md-header-anchor"></a><span>5-4 视图的建立更新删除</span></h5><p><span>概念：视图是三级模式两级映像中外模式的主要形式，是建立在基本表之上的，为了简化用户的操作</span></p><p><span>（1）视图的创建</span></p><p><span>1）语法：CREATE VIEW &lt;视图名&gt; [(&lt;列名&gt;[,列名]……)]  AS 子查询</span>
<span>2）例1：建立计算机专业教师的视图（应有教师编号，姓名，性别，年龄）</span>
<code>CREATE VIEW ST01(TNO,TN,SEX,AGE)</code>
<code>AS select TNO,TN,SEX,AGE from where DEPT=‘计算机’</code></p><p><span>（2）视图的删除</span>
<span>1）语法：DROP VIEW &lt;视图名&gt;</span>
<span>2）例：删除ST01视图</span>
<code>DROP VIEW ST01</code></p><p><span>（3）视图的更新</span>
<span>1）与基本表的更新语法一致</span>
<span>2）并不是所有的视图都可以更新</span></p><p>&nbsp;</p><h4><a name="6-事务处理" class="md-header-anchor"></a><span>6 事务处理</span></h4><h5><a name="6-1-事务的概念" class="md-header-anchor"></a><span>6-1 事务的概念</span></h5><p><span>（1）概念：据库管理系统运行的基本工作单位是事务，事务是用户定义的一个数据库操作序列，这些操作 序列要么全做要么全不做，是一个不可分割的工作单位。</span></p><p><span>（2）事务的四个特性：</span>
<span>	</span><span>1）原子性（Atomicity）：事务是数据库的逻辑工作单位，事务的所有操作在数据库中要么 全做要么全都不做</span>
<span>	</span><span>2）一致性（Consistency）：事务的执行使数据库从一个一致性状态变到另一个一致性状态</span>
<span>	</span><span>3）隔离性（Isolation）：一个事务的执行不能被其他事务干扰</span>
<span>	</span><span>4）持续性（永久性）（Durability）：指一个事务一旦提交，它对数据库的改变必须是永久的，即便系统出现故障时也是如此</span></p><p><span>（3）事务通常以BEGIN TRANSACTION（事务开始）语句开始，以COMMIT或ROLLBACK语句结束。COMMIT称为&quot;事务提交语句&quot;,表示事务执行成功地结束，把事务对数据库的修改写入磁盘（事 务对数据库的操作首先是在缓冲区中进行的）；ROLLBACK称为&quot;事务回退语句&quot;,表示事务执行不成 功地结束，即把事务对数据库的修改进行恢复</span></p><h5><a name="6-2-数据库的恢复" class="md-header-anchor"></a><span>6-2 数据库的恢复</span></h5><p><span>（1）事务故障</span>
<span>1）事务故障：发生事务故障，事务还没有到达预期的终点（COMMIT或是显示ROLLBACK），被迫中断的事务可能已经对数据库解进行了修改，为了消除数据库的影响，应回滚事务（ROLLBACK）即撤销事务（UNDO），将数据库恢复到修改前的初始状态。</span>
<span>2）系统故障：由于硬件故障，操作系统故障，DBMS故障，突然断电等导致的故障；对数据库的影响及补救操作</span>
<span>	</span><span>①未完成的事务的结果已经写入数据库或尚未提交的事务，执行撤销UNDO操作，强制撤销未完成（未提交）的事务,</span>
<span>	</span><span>②提交的事务对数据库的更新结果还在缓冲区中，尚未写入磁盘（数据库不一致）,</span>
<span>		</span><span>撤销（UNDO）所有未完成（未提交）的事务，重做REDO所有已提交的事务</span>
<span>3）介质故障</span>
<span>4）计算机病毒</span></p><p><span>（2）数据库恢复</span>
<span>	</span><span>1）基本原理：数据冗余技术</span>
<span>	</span><span>2）常见建机制：</span>
<span>	</span><span>①数据转存</span>
<span>	</span><span>②登记日志文件：记录事务对数据库更新操作的文件（只记录插入，修改，删除操作）；</span>
<span>		</span><span>ⅰ)登记内容：事务的开始；事务的结束；各事务所有的更新</span>
<span>		</span><span>ⅱ)登记原则：登记次序严格按照并发事务执行的时间次序；必须先写日志文件，再写数据库（便于恢复数据）</span></p><p>&nbsp;</p><h5><a name="6-3-数据并发控制" class="md-header-anchor"></a><span>6-3 数据并发控制</span></h5><p><span>（1）概念：在多用户共享系统中，许多事务可能同时对同一数据进行操作，称为&quot;并发操作&quot;</span>
<span>（2）并发控制问题：</span>
<span>①丢失修改：前一次的修改记录被后一次的修改所覆盖（买飞机票）</span>
<span>当两个事务或多个事务选择同一个数据，并且基于最初的选定的值更新该数据时，数据会发生丢失修改，例：事务1和事务2先后读同一数据R=30，事务1执行R-1，并将结果R=29写回，事务2执行R-1，并将结果R=29写回，事务2提交的结果会覆盖事务1 对数据的修改，从而导致事务1 的修改丢失。</span></p><figure><table><thead><tr><th><span>事务1</span></th><th><span>事务2</span></th></tr></thead><tbody><tr><td><span>①读R=30</span></td><td>&nbsp;</td></tr><tr><td><span>②</span></td><td><span>读R=30</span></td></tr><tr><td><span>③R=R-1写回</span></td><td>&nbsp;</td></tr><tr><td><span>④</span></td><td><span>R=R-1写回</span></td></tr></tbody></table></figure><p><span>②脏读：有回滚；一个事务读取了另一个并行未提交事务写的数据，例：当事务1修改了某一数据，并写回磁盘，事务2读取了这里数据后，事务1由于某种原因被撤销（回滚），这时事务1修改过的数据恢复原值，事务2读到的数据就与数据库的数据不一致，是不正确的数据。</span></p><figure><table><thead><tr><th><span>事务1</span></th><th><span>事务2</span></th></tr></thead><tbody><tr><td><span>①读A=20      读B=30      求和=50</span></td><td>&nbsp;</td></tr><tr><td><span>②</span></td><td><span>读A=20     A=A+30     写回A=50</span></td></tr><tr><td><span>③读A=50      读B=30      求和=70      验算不对</span></td><td>&nbsp;</td></tr></tbody></table></figure><p><span>	</span><span>③不可重复读：两次读的结果不一样，验算结果不一样；一个事务重新读取前面的数据过的数据，发现该数据已经被另一个事务修改，例：事务1读取某一数据后，事务2对其进行了修改，当事务2再次读数据时，得到的与第一次不同的值</span></p><figure><table><thead><tr><th><span>事务1</span></th><th><span>事务2</span></th></tr></thead><tbody><tr><td><span>①读A=20      A=A+30      写回A=50</span></td><td>&nbsp;</td></tr><tr><td><span>②</span></td><td><span>读A=20</span></td></tr><tr><td><span>③ROLLBACK     A恢复为20</span></td><td>&nbsp;</td></tr></tbody></table></figure><h5><a name="6-4--封锁机制" class="md-header-anchor"></a><span>6-4  封锁机制</span></h5><h6><a name="6-4-1-封锁类型" class="md-header-anchor"></a><span>6-4-1 封锁类型</span></h6><p><span>（1）排他锁（X锁，写锁）：若事务T对数据加排他锁，只有事务T能对该数据进行读和写操作，其他事务无法对该数据进行读写操作</span>
<span>（2）共享锁（S锁，读锁）：若事务T对数据加共享锁，其他事务可以对该数据进行读操作</span>
<span>（3）X锁与S锁的相容性：S-S锁相容，可以多个同时读；X-S锁不相容，不能即读又写；X-X锁不相容，不能同时写</span>
<span>（4）封锁粒度小则并发性高，但开销大；封锁粒度大则并发性低，但开销小</span></p><h6><a name="6-4-2-封锁协议" class="md-header-anchor"></a><span>6-4-2 封锁协议</span></h6><p><span>（1）一级封锁协议：一级封锁协议：事务T在修改数据R之前必须先对其加X锁，直到事务结束才释放。一级封锁协议可防止丢失修改，并保证事务T是可恢复的。但不能保证可重复读和不读&quot;脏&quot;数据</span>
<span>（2）二级封锁协议：一级封锁协议加上事务T在读取数据R之前先对其加S锁，读完后即可释放S锁。二级封锁协议可防止丢失修改，还可防止读&quot;脏&quot;数据。但不能保证可重复读。</span>
<span>（3）三级封锁协议：一级封锁协议加上事务T在读取数据R之前先对其加S锁，直到事务结束才释放。三级封锁协议可防止丢失修改、防止读&quot;脏&quot;数据与数据重复读。</span>
<span>（4）两段锁协议：所有事务必须分两个阶段对数据项加锁和解锁。其中扩展阶段是在对任何数据进行读、写操作之前，首先要申请并获得对该数据的封锁；收缩阶段是在释放一个封锁之后，事 务不能再申请和获得任何其他封锁。若并发执行的所有事务均遵守两段封锁协议，则对这些事务的 任何并发调度策略都是可串行化的。遵守两段封锁协议的事务可能发生死锁。</span>
<span>（5）并发调度的可串行化</span>
<span>多个事务并发执行时正确的，当且仅当其结果与某一次序串行的执行它们时的结果相同，称这种调度策略是可串行化的调度</span>
<span>可串行性是并发事务正确性的准则，按照这个准则规定，给定一个并发调度，当且仅当它是可串行化才认为是一个正确的调度</span></p><h6><a name="6-4-3-死锁与活锁" class="md-header-anchor"></a><span>6-4-3 死锁与活锁</span></h6><p><span>（1）活锁：造成一个事务永远等待的现象（例：A B C,A→C,B就处于活锁），避免活锁的策略先来先服务</span>
<span>（2）死锁：两个事务都等待对方释放资源（例：甲占有A资源，乙占有B资源；甲乙都需要AB资源才能执行，甲等待乙释放B资源，而乙等待甲释放A资源的现象）</span>
<span>（3）死锁的预防</span>
<span>1）一次加锁法：甲发现乙占用了B资源，那么甲就释放A资源，让乙先用，此法一定遵守两段锁协议</span>
<span>2）顺序加锁法：让甲乙按照顺序占有资源，即让甲乙都按照先锁A再锁B的顺序进行资源占用，这样乙就不能先占用B资源</span>
<span>（4）死锁的诊断与解出</span>
<span>1）超时法：在设定的时间内事务没有被完成，则默认该事务发生死锁。</span>
<span>	</span><span>优点：实现简单</span>
<span>	</span><span>缺点：若设定时间太短，容易误判死锁；若设定时间太长，死锁不能及时被发现，并发度低</span>
<span>2）等待图法：出现循环，就默认为出现死锁</span></p><p><span>6-5 访问控制</span>
<span>（1）授权</span>
<span>	</span><span>1）语法：</span>
<span>	</span><span>GRANT</span><span>	</span><span>&lt;权限&gt;[1……n]</span>
<span>	</span><span>ON</span><span>	</span><span>&lt;对象类型&gt;&lt;对象名&gt;</span>
<span>	</span><span>TO</span><span>	</span><span>&lt;用户&gt;[1……n]</span>
<span>	</span><span>WITH GRANT OPTION</span>
<span>	</span><span>说明：①WITH GRANT OPTION子句，获得权限的用户还可以将权限赋给其他用户；</span>
<span>				</span><span>②ALL PRIVILEGES 所有权限</span>
<span>				</span><span>③public 所有用户，update(字段名)修改某个字段的权限</span></p><p><span>（2）权限回收</span>
<span>1）语法：REVOKE&lt;杈限&gt;[1……n]</span>
<span> </span><span>				</span><span>ON</span><span>	</span><span>&lt;对象类型&gt;</span><span>	</span><span>&lt;对象名&gt;</span>
<span>				</span><span>FROM</span><span>	</span><span>&lt;用户&gt;[1……n]</span>
<span>				</span><span> [RESTRICT|CASCADE]</span></p><p>&nbsp;</p><h4><a name="7-存储过程函数及触发器" class="md-header-anchor"></a><span>7 存储过程函数及触发器</span></h4><h5><a name="7-1-存储过程" class="md-header-anchor"></a><span>7-1 存储过程</span></h5><p><span>（1）概念：一组为完成特定功能的SQL语句集</span>
<span>（2）例1：使用以前S_P_J数据库的S、P、J、和SPJ表中创新一个带参数的存储过程Spjcx该存储过程的功能是：当任意输入一个供应商名时，将返回该供应商的供应商号、零件名、数 量和价格</span>
<code>USE P_S_J;</code>
<code>GO</code>
<code>CREATE  procedure Spjcx @SNAME VARCHAR(12)</code>
<code>AS</code><span> </span>
<code>select SPJ.SNO 供应商编号,PNAME 零件名,QTY 数量,PRICE 价格</code>
<code>FROM SPJ,S,P</code>
<code>WHERE SPJ.SNO=S.SNO AND @SNAME=SNAME AND P.PNO=SPJ.PNO;</code></p><p><code>EXEC Spjcx &#39;&#39;;</code></p><h5><a name="7-2-函数" class="md-header-anchor"></a><span>7-2 函数</span></h5><p><span>（1）概念：特殊的存储过程</span>
<span>（2）例2：创建一个函数FN_SPJ，功能是当任意输入供应商号和零件号，统计出该供应商供应该零件的总数</span>
<code>create function FN_SPJ</code>
<code>(@SNO char(4),@PNO char(4))</code>
<code>returns int</code>
<code>as</code><span> </span>
<code>begin</code><span> </span>
<span>    </span><code>declare @total int</code>
<span>    </span><code>select @total=SUM(QTY) from SPJ</code>
<span>    </span><code>where SNO=@SNO and PNO=@PNO</code>
<span>    </span><code>return @total</code>
<code>end</code></p><p><code>select dbo.FN_SPJ(&#39;S1&#39;,&#39;P1&#39;)as 总数</code></p><p><span>（3）例3：使用以前S_P_J数据库的S、P、J、和SPJ表中创新一个带参数的函数fn_spjcx ,该函数的功能是：当任意输入一个供应商名时，将返回该供应商的供应商号、零件名、数 量和价格。</span>
<code>create function fn_define_spjcx(@SNAME varchar(12))</code>
<code>returns @t1 table(id int,name varchar(20))</code>
<code>as</code>
<code>begin</code>
<span>  </span><code>insert into @t1 values (1,&#39;重庆&#39;);</code>
<span>  </span><code>insert into @t1 values (2,&#39;北京&#39;);</code>
<span>  </span><code>return</code>
<code>end</code>
<code>select * from dbo.fn_define_spjcx(4564)</code></p><p>&nbsp;</p><h5><a name="7-3-触发器" class="md-header-anchor"></a><span>7-3 触发器</span></h5><p><span>（1）概念：触发器是一类特殊的存储过程，通过某些事件触发（绑定在某个表上（行、列）），并自动执行，可用来对表实施严格复杂的完整性约束</span>
<span>（2）作用：①强制数据库间的引用完整性；②级联修改数据库中所有相关表，自动触发与之相关的操作；③跟踪变化，撤销或回滚违法操作，防止非法修改数据；④返回自定义的错误信息，约束违法完成，而触发器可以；⑤触发器可以调用更多存储过程</span>
<span>（3）分类：</span>
<span>1）DML触发器：①insert触发器：向表中插入数据触发；②delete触发器：从表中删除数据触发；③update触发器：修改表中数据时触发</span>
<span>2）DDL触发器：①create触发器；②alter触发器；③drop触发器</span></p><p><span>（4）基本语法：</span>
<span>create trigger &lt;名称&gt; on &lt;表名|视图名&gt;</span>
<span>[with encryption(加密)]</span>
<span>for | after | instead of [delete,insert,update]</span>
<span>as SQL语句块（触发器要执行的操作）</span></p><p><span>说明：for(before)：在执行更新（删除、插入）前执行触发器</span>
<span>			</span><span>after：在执行更新（删除、插入）后执行触发器</span>
<span>			</span><span>instead of：不执行更新（删除、插入）操作，而是执行触发器的内容，及激活触发器的代码（SQL）语句不执行，而是执行触发器中的语句块</span></p><p><span>（5）两个特殊临时表</span>
<span>1）inserted表：保存了insert操作中新插入的数据和update操作更新后的数据</span>
<span>2）deleted表：保存了delete操作删除的数据和update操作更新前的数据</span></p><p><span>（6）例1:建立触发器，在t_user表插入数据时(1,’admin’,’123’)自动插入默认权限(1，1，1，0)</span>
<code>create trigger insert_aute</code>
<code>on t_uer</code>
<code>for insert</code>
<code>as</code>
<code>begin</code>
<code>declare @id int</code>
<code>select @id=id from inserted</code>
<code>insert into t_priv</code>
<code>values(@id,1,1,0)</code>
<code>end</code></p><p><span>例2：在删除用户时，自动删除此用户对应的权限 </span>
<code>create trigger delete_aute</code>
<code>on t_uer</code>
<code>for delete</code>
<code>as</code>
<code>begin</code>
<code>declare @id int</code>
<code>select @id=id from deleted</code>
<code>delete from t_priv</code>
<code>where id=@id</code>
<code>end</code></p><p>&nbsp;</p></div>
</body>
</html>