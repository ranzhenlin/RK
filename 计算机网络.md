

[TOC]

#### 1 计算机网络概论

#### 1-1 计算机网络的定义与分类

###### 1-1-1 计算机网络定义

用通信线路把若干台电子计算机相互连接起来，用来实现信息交换和资源共享

###### 1-1-2 分类

（1）传输介质：有线网；无线网

（2）覆盖范围和规模：局域网（LAN）；城域网（MAN）；广域网（WAN）

（3）按通信方式：点对点式传输网络；广播式传输网络

（4）按服务方式：客户机/服务器网络；对等网（每一台计算机都可以充当服务器）

（5）按逻辑结构：通信子网；资源子网



#### 1-2网络体系结构与网络协议

##### 1-2-1 网络协议

（1）三要素：==语义，语法，时序==
	语义表示要做什么，语法怎么做，时序按照什么顺序做	

##### 1-2-2 网络体系结构

**OSI参考模型**

（1）自下而上分别为：==物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。==

（2）划分原则：
①网中各主机都具有相同的层次
②不同主机的相同层次具有相同的功能
③同一主机内相邻层之间通过接口通信
④每层可以使用下层提供的服务，并向上层提供服务
⑤不同主机的相同层通过协议来实现同等层之间的通信

（3）各层功能
1）物理层：物理层利用传输介质为同通信的主机之间建立、管理和释放物理连接，实现比特流的透明传输，为数据链路层提供数据传输服务；数据传输基本单位为比特流；
2）数据链路层：数据链路层在物理层提供比特流传输的基础上，通过建立时间链路连接，采用差错控制与流量控制，时有差错的网络线路变成无差错的数据链路；数据传输单元是帧
3）网络层：通过路由选择算法为分组通过通信子网选择适当的传输路径，实现流量控制，拥塞控制与网路互联的功能；数据传输单元为分组
4）传输层：为分布在不同地理位置的计算机的进程通信提供可靠的端-端连接与数据传输；传输层向上层屏蔽了底层数据通信的细节；数据传输单元为报文
5）会话层：负责维护两个会话主机间==连接的建立==、管理和终止以及数据的交换
6）表示层：负责通信系统之间的数据格式变换、数据加密与解密、数据压缩及恢复
7）应用层：实现协同工作的应用程序间的通信过程控制

（2）注意：
①连接主机的==物理介质不在OSI环境==中
②==操作系统也不在OSI环境中==



**TCP/IP模型**

（1）自下而上分别为：==网络接口层、互联网层、传输层、应用层==
（2）对应OSI参考模型：网络接口层（物理层，数据链路层）；互联网层（网络层）；传输层（传输层）；
		应用层（会话层、表示层和应用层）
（3）各层功能
1）网络接口层：负责收发IP分组；
2）互联网层：处理来自传输层的数据发送请求；处理收到的分组；处理网络的路由选择，流量控制和差错控制；寻址与路由选择
3）传输层：分组在会话进程间建立和维护端-端连接，实现网络环境中分布式进程通信
		TCP协议：传输控制协议，可靠的，面向连接，面向字节流的传输协议，可提供较完善的流量控制与拥塞控制功能；
		UDP协议：用户数据报协议，不可靠，无连接的传输控制协议
4）应用层：常见协议
①远程登录协议（TELNET）,端口23
②文件传输协议（FTP），端口20,21
③简单邮件传输协议（SMTP），端口25
④邮局协议（POP3）端口110

.⑤超文本传输协议（HTTP），端口80
⑥域名系统（DNS），端口53
⑦动态主机配置协议（DHCP），端口67,68
⑧简单网络管理协议（SNMP），端口25



##### 1-2-3 实体、协议、服务之间的关系

（1）实体：任何可发送或接受信息的硬件或软件进程；
（2）协议：控制两个对等实体（或多个实体）进行通信的规则的集合: (水平的)
（3）在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务（垂直的）；要实现本层协议，还需要使用下层所提供的服务。同一系统相邻两层的实体进行交互的地方，称为服务访问点SAP (Service Access Point)，下层的协议的实现对上层的服务用户是透明的。IP over Everything ，Everything over IP



#### 1-3 网络拓扑结构

（1）星型拓扑：中心节点的故障可能导致全网瘫痪
（2）环形拓扑：一个节点故障可能导致整个网络瘫痪
（3）==总线拓扑==：必须解决多节点同时访问总线的问题，通常用于==局域网==
（4）树状拓扑：星型的拓展，适用于信息汇聚
（5）==网状拓扑==：可靠性高，路由选择算法、流量控制和拥塞控制比较复杂，通常用于==广域网==

#### 1-4  数据交互方式

<img src="%E5%9B%BE%E7%89%87/image-20210414203439759.png" alt="image-20210414203439759" style="zoom:60%;" />

1-4-1 线路交换
（1）概念：两台计算机通过通信子网进行数据交换前，首先在资源子网中建立一条实际的物理线路连接
（2）交换过程：①线路建立；②数据交换；③线路释放；
（3）优点：①在完成线路连接后，该物理线路为两台计算机专用线路，通信实时性强；②适用于交互式会话类通信
（4）缺点：①不适用于计算机间的突发性通信；②：不具备信息存储能力，不能平滑通信量；③不具备差错控制能力，无法发现与纠正传输错误；

1-4-2 报文存储转发：不论传送数据的长度是多少，都把它作为一个逻辑单元，加上目的地址、源地址、控制信息，按规定格式打成一个包发送，这个数据包就叫做报文，这种存储转发交换方式就叫做报文交换，不适合实时通信应用环境（如语音、视频等）

1-4-3 报文分组交换：将一个长的报文分解为多个短小（一般不超过1000字节）的组，叫做报文分组

1-4-4 数据报：在分组传输前不需要在，源主机与目的主机间建立线路连接，源主机发出的每一个分组都可以独立选择一条路径，每个分组都可能通过不同的通信线路到达目的主机。IP交换机通常采用数据报

1-4-5虚电路：结合数据报与线路交换，ATM异步交换机通常采用该方式



#### 1-5 分组交互中的延时

1-5-1 延时概念：是指一个分组从源主机出发，经过分组交换网（或链路）分传输，到达目的主机所需的时间
1-5-2 延时分类：
（1）处理延时：路由器拆包检查分组头部与数据部分，选择合适线路所用时间，交换结点为存储转发而进行一些必要的处理所花费的时间；
（2）排队延时：检查完成，找到合适线路后，将分组放到转发队列中，从进入队列到开始发送所用时间，结点缓存队列中分组排队所经历的时延。（取决于当时的通信量）
（3）发送延时：路由器端口发送数据的延时，发送延时=分组长度/发送速率，==发生在其内部的传输器中==
（4）传播延时：在传输介质上的延时，传输延时=介质长度/信号传播速度，==发生在其外部的传输信道媒体上==
注：数据的发送速率不是比特在链路上的传播速率



#### 1-6 网络性能

（1）速率（比特每秒b/s） ：每秒钟传输二进制的==位数 $S=1/T(bps)$，==T发送每比特所用时间（秒），数据量/信息量的单位； $1kbps=1000bps$

（2）带宽（两种） : ①频域称谓，赫兹吧Hz，信号具有的频带宽度； ②时域称谓，比特每秒(b/s)，通信线路的最高数据率；两者本质一样,宽度越大，传输速率自然越高；

（3）吞吐量：==单位时间内通过某个网络(或信道、接口)的数据量==，受网络的带宽或网络的额定速率影响；

（4）时延：处理延时+排队延时+发送延时+传播延时；

（5）时延带宽积：时延带宽积(体积)-传播时延(长) x带宽(截面积)，以比特为单位的链路长度

（6）往返时间（RTT）:简单来说，就是两倍传播时延（实际上还包括处理时延，排队时延，转发时的发送时延）；

（7）利用率：
1）信道利用率（某信道有百分之几的时间是被利用的）；
2）网络利用率全网络的信道利用率的加权平均值) 
$D=\frac{{{D}_{0}}}{1-U}$ ，U为利用率,，D为时延，因此利用率不是越高越好。减少方法：增大线路的带宽



### 2 网络层

##### 2-1物理层的基本功能

（1）主要任务：保证比特流通过传输介质的正确传输，为数据链路层提供数据传输服务。

（2）重要功能：根据所用传输介质的不同，制定相应的物理层协议，规定数据信号编码方式，传输速率，以及相关通信参数

（3）主要目的：屏蔽网络层采用的传输介质、通信设备与通信技术的差异，使数据链路层只需要考虑如何实现物理层的服务，而不需要考虑物理层的功能具体使用了那种传输介质，通讯设备与技术实现

（4）四个特性：
①机械特性 ：指明接口所用接线器的形状和尺寸、引脚数目和排列、固定和锁定装置等等
②电气特性 ：指明接口电缆上各条线上出现的电压范围
③功能特性 ：指明出现的各种电压代表的意义（0或者1）
④过程特性： 指明对于不同功能的各种可能事件的出现顺序

##### 2-2 信息交互方式

（1）单工总线：只能接收数据信息，不能发送数据信息；例：收音机
（2）半双工总线：即可接收数据信息，也可以发送数据信息，一方发送数据信息，另一方只能接收信息，收发交替进行；例：对讲机
（3）全双工总线：收发数据信息同时进行，例：电话

##### 2-3 相关术语

（1）数据(data)：运送消息的实体。
（2）信号(signal)：数据的电气的或电磁的表现。
（3）“模拟的” (analogous)：代表消息的参数的取值是==连续==的。
（4）“数字的” (digital)：代表消息的参数的取值是==离散==的。
（5）码元(code)：在使用时间域(或简称为时域)的波形表示数字信号时，==代表不同离散数值的基本波形==，码元是信息量的载体。
（6）基带信号：来自信源的信号，为使信道能够传输低频分量和直流分量，需要进行调制而尚未调制的信号，也称数字基带信号；
（7）基带调制：(仅对波形进行变换)
（8）带通调制（使用载波调制） : ①调幅: ②调频: ③调相；
（9）频带信号：将各种数字基带信号转换成适于信道传输的数字调制信号(已调信号或频带信号)
（10）在链路上传输的信号分成两种：基带信号，宽带信号

1）基带传输：基带信号（对应数字信号）：将数字信号0和1直接用两种不同的电压表示，然后传到数字信道上传输，这种传输叫做基带传输，通常用于==局域网==。

2）频带传输：频带信号：它也是一种模拟信号，用数字信号对特定频率的载波进行调制，将其变成适合于传送在模拟线路上传输的信号（==远距离传输或无线传输==），不过频带传输和宽带传输有细微不同，宽带传输的子信道比频带传输的子信道更多，通常用于==广域网==

3）宽带信号（对应模拟信号）：借助频带传输，将基带信号调制后形成模拟信号将链路容量分解为两个或多个信道，每个信道可以携带不同的信号 宽带中所有的信道可以同时互不干扰的发送信号。将基带信号调制后形成模拟信号，并在模拟信道上传输，而这种传输叫做宽带传输。

4）数字数据通过编码可以变成数字信号，方式有：非归零码，曼彻斯特编码（基带传输），差分曼彻斯特编码

5）数字数据通过调制可以变成模拟信号，方式有：幅移键控(ASK)，频移键控(FSK)，相移键控(PSK)，正交振幅调制(QAM)（频带传输）

6）模拟数据通过编码可以变成数字信号，步骤为：采样、量化、编码（基带传输）

##### 2-4 调制解调器

调制器：将数字信号转换成模拟信号（D-A）;
解调器：将模拟信号转换为数字信号（A-D）;

##### 2-5 脉冲编码调制（PCM）

（1）将模拟信号转换为数字信号
（2）==步骤：采样、量化、编码==

（3）抽样：$f\ge 2B或f\text{=}1/T\ge 2{{f}_{\max }}$ 采==样频率通常为2倍的通信信道带宽==（B）或信道允许通过的最高信号频率（f~max~）;

（4）量化：将样本幅度按量化级取值的过程，微分思想

（5）编码：用相应位数的二进制代码表示量化后的样本量级

##### 2-6 多路复用技术

（1）作用：为了充分利用传输介质的带宽，需要在一条物理线路建立多条通信信道。
（2）分类：
1）时分多路（TDM）:以信道传输时间为对象，通过设置为多个信道分配互不重叠的时间片，达到同时传输多路信号的目的；
2）频分多路（FDM）:以信道传输时间为对象，通过设置为多个信道分配互不重叠的信道，达到同时传输多路信号的目的；
3）波分多路（WDM）:在一条光纤上复用多路光载波信号，他是光频段的频分多路复用；
4）码分多址（CDMA）:通过为每一位用户分配一种码型，使多个用户同时在一个信道上而部互相干扰（3G手机移动通信共享信道基本方法）
5）正交频分复用（OFDM）:蜂窝移动通信，802.11标准的WLAN和802.16标准的WLAN的物理层广泛使用

#####  2-7 接入技术

（1）电话线拨号接入（PSTN）：家庭用户接入互联网的普遍的窄带接入方式。即通过电话线，利用当地运营商提供的接入号码，拨号接入互联网,速率不超过56Kbps。特点是使用方便，只需有效的电话线及自带调制解调器（MODEM）的PC就可完成接入。

（2）ISDN：俗称“一线通”。它采用数字传输和数字交换技术，将电话、传真、数据、图像等多种业务综合在一个统一的数字网络中进行传输和处理。用户利用一条ISDN用户线路，可以在上网的同时拨打电话、收发传真，就像两条电话线一样。

（3）==ADSL接入：非对称数字用户==，在通过本地环路提供数字服务的技术中，最有效的类型之一是数字用户线数字用户线)（Digital Subscriber Line，DSL）技术，是运用最广泛的铜线接入方式。ADSL的数据传输速率可根据线路的情况进行自动调整，它以“尽力而为”的方式进行数据传输

（4）HFC（CABLEMODEM）：是一种基于有线电视网络铜线资源的接入方式。具有专线上网的连接特点，允许用户通过有线电视网)实现高速接入互联网。

（5）==光纤宽带接入==：==单模==（远程），多模通过光纤接入到小区节点节点或楼道，再由网线连接到各个共享点上（一般不超过100米），提供一定区域的高速互联接入，分为光纤到家（FTTH），光纤到楼（FTTB）,光纤到路边（FTTC），光纤到节点（FTTN）,光纤到办公室（FTTO）

（6）无源光网络（PON）：PON无源光网络技术是一种点对多点的光纤传输和接入技术。

（7）无线网络：是一种有线接入的延伸技术，使用无线射频(RF)技术越空收发数据，减少使用电线连接，

（8）电力网接入（PLC）：电力线通信(Power Line Communication) 技术，是指利用电力线传输数据和媒体信号的一种通信方式，也称电力线载波（Power Line Carrier）。把载有信息的高频加载于电流，然后用电线传输到接受信息的适配器，再把高频从电流中分离出来并传送到计算机或电话。

##### 2-8 传输介质

（1）光纤：频带宽（数据传输速率快）、损耗低（适用于眼距离传输）、质量轻、抗干扰能力强，分为==单模（远距离）==和==双模==（近距离）；
（2）双绞线：最大传输距离不超过一百米，超过==100米==后信号要发生衰减；分为==屏蔽式STP==与==非屏蔽式UTP==
（3）同轴电缆；
（4）电磁波（WiFi）
（5）红外线；
（6）蓝牙：不超过10米
（7）卫星

##### 2-9 网络设备及协议

（1）中继器（RP repeater）：作用是放大信号，补偿信号衰减，支持远距离的通信

（2）集线器（HUB）：作用与中继器相似，但是它会==平分带宽==





### 3 数据链路层

##### 3-1 基本概念

3-1-1 分层

（1）逻辑链路控制层（LLC子层）；（2）媒介访问控制子层（MAC子层）

（2）两个标准：DIX Ethernet V2标准与IEEE的802.3标准只有很小的差别，因此可以将802.3局域网简称为“以太网".

3-1-2 作用

（1）数据链路管理；（2）帧同步；（3）流量控制；（4）差错控制；（5）透明传输；（6）寻址

##### 3-2 HDLC协议

（1）概念：高级数据链路控制HDLC（High-Level Data Link Control），是一个在同步网上传输数据、==面向比特==的数据链路层协议；
 数据报文可透明传输，用于实现==透明传输==的是“==零比特插入法==”，易于硬件实现。
零比特插入法：对于连续出现5个比特1，就在第5个比特1后插入一个0比特，接收端接收到比特流时，扫描比特流，发现连续5个比特1就将其后面的比特0删除，从而还原出原来的数据。

（2）通信方式：采用全双工通信，采用CRC进行错误校验

（3）工作方式： HDLC站分为：主站、从站和复合站。
  1) 主站：发送命令（包括数据信息）帧，接收响应帧，并负责对整个链路的控制系统的初启、流程控制、差错检测或恢复等。
  2) 从站：接收由主站发来的命令帧，向主站发送响应帧，并且配合主站参与差错恢复等链路控制。
  3）复合站：既能发送，又能接收命令帧和响应帧，并且负责这整个链路的控制。

（4）协议特点：对帧编号，有确认机制，可靠性高

##### 3-3 PPP协议

（1）概念：点对点协议PPP（Point-to-Point Protocol）是目前使用最广泛的数据链路层协议，用于使用拨号电话接入因特网时一般都使用PPP协议，是==面向字节==的数据链路层协议，==PPP协议只支持全双工链路==。

（2）协议特点
	1) 简单，对数据链路层的帧，==无需差错恢复，无需序号，无需流量控制==，直接交由上层协议完成
	2)封装成帧，PPP协议必须规定特殊的字符作为帧定界符（标志着一个帧的开始和结束）。
	3)透明传输，与帧定界符一样的比特组合应该如何处理。
	4) 差错检测，接收到错误的帧就直接丢弃。
	5)最大传送单，数据部分最大长度MTU。
	6)可靠性不高

（3）透明传输实现方法：字节填充法

（4）链路认证协议：
	1）PAP：口令认证协议，明文传输用户名和口令
	2）CHAP：查询-握手认证协议，暗文传输用户名和口令

（5）使用范围：==路由器与路由器之间使用，同步、异步传输都支持==

##### 3-4 网络设备

###### 3-4-1 交换机

（1）概念：交换机（Switch）是一种用于电（光）信号转发的网络设备。它可以为接入交换机的任意两个网络节点网络节点提供独享的电信号通路。最常见的交换机是以太网交换机。其他常见的还有电话语音交换机、光纤交换机等。

（2）作用：

1. 连接同种网络
2. ==学习MAC==：以太网交换机了解每一端口相连设备的MAC地址，并将地址同相应的端口映射起来存放在交换机缓存中的MAC地址表中，==即插即用设备== 
3. ==转发/过滤==：当一个数据帧的目的地址在MAC地址表中有映射时，它被转发到连接目的节点的端口而不是所有端口（如该数据帧为广播/组播帧则转发至所有端口）
4. ==消除回路==：当交换机包括一个冗余回路时，以太网交换机通过生成树协议避免回路的产生，同时允许存在后备路径。

（3）MAC地址（物理地址）：网络中每台设备都有一个唯一的网络标识，这个地址叫MAC地址或网卡地址，由网络设备制造商生产时写在硬件内部，MAC地址是==48位==的二进制（6个字节）组成，通常表示为==12个16进制数==，每2个16进制数之间用冒号隔开，如08:00:20:0A:8C:6D，

（4）优点：

- ==每个端口结点所占用的带宽不会因为端口结点数目的增加而减少，且整个交换机的总带宽会随着端口结点的增加而增加；==
- ==按MAC地址转发，都能隔离冲突域，不能隔离广播域（路由器可以隔离广播域）==

（6）交换方式：

- 直通式：帧在接口后只检查目的地址，几乎马上就被传出去

- 存储转发：先将接收到的帧缓存到高速缓存器，检查数据正确性

  

###### 3-4-2 网卡

（1）概念：网卡也称为==网络适配器==或者网络接口卡（Network Interface Card,NIC）。网卡及其驱动程序事实上已基本实现了网络协议中底部两层的功能，具体负责==主机向媒体收/发信号==，实现帧一级协议的有关功能

（2）功能特点：

- （1）数据的封装与解封，发送时将上一层传递来的数据加上首部和尾部，成为以太网的帧。接收时将以太网的帧剥去首部和尾部，然后送交上一层
- 链路管理。主要是通过CSMA／CD（带冲突检测的载波监听多路访问）协议来实现
- 数据编码与译码。即曼彻斯特编码与译码

##### 3-5 注意

（1）由于TCP/IP体系经常使用的局域网是DIX Ethernet V2而不是802.3标准中的几种局域网，因此现在802委员会制定的逻辑链路控制子层LLC (即802.2标准)的作用已经不大了
（2）很多厂商生产的适配器上就仅装有MAC协议而没有LLC协议
（3）所以我们以后一般不考虑LLC子层。



### 4  数据链路层----介质访问控制子层（MAC）

##### 4-1 局域网的分类（3类CSMA/CD，Token Bus，Token Ring）及特点

**4-1-1  ==带有冲突检测的载波侦听多路访问控制（CSMA/CD）的Ethernet，简称以太网==**

（1）多点接入：表示许多计算机以多点接入的方式连接在一根总线上；

（2）载波监听：是指每一个站在发送数据之前先要检测一下总线上是否有其他计算机在发送数据，如果有，则暂时不要发送数据，以免发生碰撞。总线上并没有什么“载波”。因此，“载波监听”就是用电子技术检测总线上有没有其他计算机发送的数据信号；

（3）冲突检测：就是计算机边发送数据边检测信道上的信号电压大小；当几个站同时在总线上发送数据时，总线上的信号电压摆动值将会增大(互相叠加)。当一个站检测到的信号电压摆动值超过一定的门限值时，就认为总线上至少有两个站同时在发送数据，表明产生了冲突。

（4）检测到碰撞后：在发生碰撞时，总线上传输的信号产生了严重的失真，无法从中恢复出有用的信息来。每一个正在发送数据的站，一旦发现总线上出现了碰撞，就要立即停止发送，免得继续浪费网络资源，然后等待一段随机时间后再次发送



**4-1-2 令牌总线网（Token Bus）**

（1）令牌是一种特殊结构的控制帧

（2）规定每个节点令牌的持有THT时间（10s）

**4-1-3 令牌环网**

（1）令牌是一种MAC控制帧，令牌帧头有忙闲标志



##### 4-2 局域网的参考模型及协议标准

（1）802.1:802协议概论
（2）802.2:逻辑链路控制层（LLC）协议。
（3）802.3:以太网的CSMA/CD（载波监听多路访问/冲突检测）协议。 
（4）802.4:令牌总线（Token Bus）协议。 
（5）802.5:令牌环（Token Ring）协议。 
（6）802.6:城域网协议。
（7）802.7:宽带技术协议。 
（8）802.8:光纤技术协议。 
（9）802.9:局域网上的语音/数据集成规范。 
（10）802.10:局域网安全互操作标准。 
（11）==802.11:无线局域网（WLAN）标准协议。==

4-2-1 标准组织

- IEEE：电气与电子工程师协会
- IETF： Internet工程任务组
- ISP：互联网提供商
- ISO：国际标准组织
- ITU：国际电信联盟



##### 4-3 Ethernet(以太网)工作原理

==（1）使用CSMA/CD技术：先听先发，边听变发，冲突停止，延迟重发==

（2）从网络上发往本站的帧分为以下3种:
	1）单播(unicast)帧(一对一)
	2）广播(broadcast)帧(一对全体)
	3）多播(multicast)帧(一对多)

##### 4-4  多接口网桥-以太网交换机

（1）以太网交换机通常都有十几个接口。因此以太网交换机==实质==上就是一个==多接口==的==网桥==，可见交换机工作在数据链路层。

（2）以太网交换机的每个接口都直接与主机相连，并且一般都工作在全双工方式

（3）交换机能同时连通许多对的接口，使每一对相互通信的主机都能像独占通信媒体那样，进行无碰撞地传输数据

（4）以太网交换机由于使用了专用的交换结构芯片,其交换速率就较高



##### 4-5 虚拟局域网（VLAN）

4-5-1 概念：虚拟局域网VLAN是由一些局域网网段构成的与物理位置无关的逻辑组
（1）这些网段具有某些共同的需求；
（2）每一个VLAN的帧都有一个明确的标识符，指明发送这个帧的工作站是属于哪一个VLAN

4-5-2 作用：==管理广播域，分割广播域，防止广播风暴==

4-5-3 划分方法

（1）基于交换机端口
（2）基于主机MAC地址
（3）基于IP地址

4-5-4 特点

（1）虚拟局域网其实只是局域网给用户提供的一种服务,而并不是一种新型局域网。

（2）虚拟局域网限制了接收广播信息的工作站数，使得网络不会因传播过多的广播信息(即“广播风暴”)而引起性能恶化

（3）虚拟局域网协议允许在以太网的帧格式中插入一个4字节的标识符，称为VLAN标记(tag)，用来指明发送该帧的工作站属于哪一个虚拟局域网

（4）协议标准为802.1Q

（5）==VLAN不仅可以隔离冲突域，也可以隔离广播域==；



### 5 网络层

##### 5-1 网络层的基本概念

5-1-1 作用：网络层通过路由选择算法，为IP分组从源主机到目的主机选择一条合适的传输路径，为传输层提供端到端数据传输服务。

##### 5-2 IPv4协议

5-2-1 IPv4协议的特点
（1）IP协议是一种无连接，不可靠的分组传输服务协议（尽力而为）
（2）IP协议是点到点的网络层通信协议
（3）IP协议屏蔽你互联网的网络在数据链路层、物理层协议与实现技术上的差异

5-2-2 IPv4分组结构

（1）IPv4分组分为两个部分：分组头和数据
（2）分组格式：（分组头长度=5*4=20B）

<img src="%E5%9B%BE%E7%89%87/IPV4.jpg" alt="IPV4" style="zoom: 80%;" />

（3）IP分组分片（标识、标志和片偏移）
1）标识：表示该分片属于哪一个分组
2）标志：
是否允许分片DF（do not fragment）：DF=0可分片；DF=1不可分片
是否为最后一个分片MF（more fragment）：MF=0最后一个分片；MF=1不是最后一个分片
3）片偏移：表示分片在分组的对应位置（8个字节的整数倍）
片偏移=分片允许数据长度/8；
例：第一个分片偏移值为：0，第二个分片偏移值为：512/8=64，第三个分片偏移值为：512+512/8=128，

##### 5-3 IPv4地址

###### 5-3-1 标准分类的IP地址

（1）表示方法：32位二进制，点分十进制（0-255）

（2）分类：
A类：0.0.0.0-127.255.255.255  其中：10.0.0.0-10.255.255.255为A类私有地址
B类：128.0.0.0-191.255.255.255  其中：172.16.0.0-172.31.255.255为B类私有地址
C类：192.0.0.0-223.255.255.255 其中：192.168.0.0-192.168.255.255为C类私有地址
D类：224.0.0.0-239.255.255.255  多播地址
E类：240.0.0.0-247.255.225.255 保留地址

==（3）特殊地址==
1）直接广播地址：网络号不变，主机号全部置1
2）受限广播地址：网络号，主机号全部置1
3）网络地址：网络号不变，主机号全部置零
4）主机地址（号）：网络号置零，主机号不变
5）回环地址：127.0.0.0
6）通常一个网段的首地址（主机号全为0）：为网段的网络地址，不能分配
7）通常一个网段的末地址（网络号全为1（255））：为网段的广播地址，不能分配

###### 5-3-2 子网标准划分

（1）基本思想：借用主机号的一部分作为子网的子网号

（2）二级子网=网络号+主机号
三级子网=网络号+<u>子网号+主机号</u>

（3）==子网掩码：用于区分网络号和主机号，网络号（子网号）为1，主机号为0==

（4）计算：
1、将IP和子网掩码转为二进制
2、将IP地址与子网掩码进行与运算得到网络地址 （在子网掩码0、1分界点处画竖线）
3、将IP地址的主机位全部置1，得到广播地址
4、排除网络地址和广播地址，得到该网段的IP范围地址范围：网络地址+1~广播地址-1
5、本网段允许分配的IP地址数目=2 的二进制主机位数次方-2（减去的为网络地址和广播地址）
6、主机号：将网络号全部置0，后所得地址

例：已知IP地址为125.145.131.9，子网掩码为255.240.0.0，问：主机号，网络地址，直接广播地址，第一个可以IP地址，最后一个可以IP地址，网络中可以的IP地址个数。

<img src="%E5%9B%BE%E7%89%87/ip%E8%AE%A1%E7%AE%97.jpg" alt="ip计算" style="zoom:80%;" />



###### 5-3-3 可变长度子网掩码（VLSM）

（1）==思想：通过在子网下再划分子网实现==

（2）例：某公司申请了一个C类IP地址202.60.31.0，要求销售部100个，财务部50个，设计部50个；请给过每个部门的IP地址范围，及子网掩码。

解：202.60.31.0，销售部100个，财务部50个，设计部50个

**分析**：先分为2个子网，再在子网下划分子网

（1）按照标准的子网掩码的方法划分子网，子网的个数为3个，需要两个二进制位来表示，而余下的6位作为主机数，26=64,无法进行划分，而2位二进制可以表示4个子网；

（2）因此可以先将其强划分为两个子网，只使用一位二进制来表示，第一个子网就可以满足销售部的100个，而第二个子网中在进行子网划分 ；

​    **解答：**（1）将202.60.31.0划分为2个子网，用一位二进制主机位即可，得到两个子网地址分别为202.60.31.==0==000 0000=202.60.31.0；202.60.31.==1==000 0000=202.60.31.128；此时两个子网的子网掩码都为255.255.255.128

（2）子网1：范围202.60.31.0000 0001-202.60.31.0111 1110=202.60.31.1-202.60.31.126，0000 0000:202.60.31.0代表网络地址，0111 1111 : 202.60.31.127代表广播地址，不能使用，所以可用的地址数为：27-2=126，满足销售部的要求

（3）子网2：将子网2下再进行子网划分，将子网2，202.60.31.1000 0000=202.60.31.128的主机位再拿一位出来作为网络位，得到两个子网202.60.31.==10==00 0000；202.60.31.==11==00 0000此时子网2.1和子网2.2的子网掩码都为255.255.255.==11==00 0000=255.255.255.192

（4）子网2.1范围为 202.60.31.1000 0001-202.60.31.1011 1110=202.60.31.129-202.60.31.190，1000 0000:202.60.31.128代表网络地址，10111 1111:202.60.31.191代表广播地址，不能使用，可以使用的地址数为：26-2=62，满足财务部的要求

（5）子网2.2范围为 202.60.31.1100 0001-202.60.31.1111 1110=202.60.31.193 -202.60.31.254，1100 0000:202.60.31.192代表网络地址，11111 1111:202.60.31.255代表广播地址，不能使用，可以使用的地址数为：26-2=62，满足设计部的要求

<img src="%E5%9B%BE%E7%89%87/%E5%8F%AF%E5%8F%98%E9%95%BF%E5%BA%A6%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81.jpg" alt="可变长度子网掩码" style="zoom:80%;" />



###### 5-3-4 无类域间路由CIDR（超网）

（1）概念：可变子网掩码的应用，在无类域间路由中无法从地址本身判断网络号的长度。

（2）斜线记法：==标准IP地址/网络号位数==
例：200.16.23.1/20：表示该IP地址的前20位为网络号，后12位主机号，即<u>1100 1000 . 0001 0001.0001</u> 0111.0000 0001；200.16.23.<u>1</u>/20：此处的1不代表主机号

（3）于标准IP地址一样，主机号全为0表示网络地址，主机号全为1表示广播地址

（4）地址聚合：将IP地址中，相同部分归并为一个（IP地址）网络地址

例：A网络202.24.16.0/23，B网络202.24.18.0/23，C网络202.24.20.0/23，D网络202.24.24.0/23汇聚成一个网路

202.24.16.0/23===11001000 00011000 0001==0000 00000000

202.24.18.0/23===11001000 00011000 0001==0010 00000000

202.24.20.0/23===11001000 00011000 0001==0100 00000000

202.24.24.0/23===11001000 00011000 0001==1100 00000000

高亮部共20位，可以将地址聚合为一个网络地址：202.24.16.0/20（将相同IP段后面的所有位数置零，得到网络地址）

（5）路由汇聚

- 概念：将网络前缀都相同的连续的IP地址组成“CIDR地址块“

- 目的：使得一个地址块可以表示很多地址，减少路由表表项和路由器间的信息交换

- 方法：==**把一串IP地址都写为二进制表示，取最长的公共前缀作为网络号**==

  

##### 5-4  NAT网络地址转换

5-4-1 概念：实现专用网络地址和公用网络地址之间的相互转换，对外隐藏内部管理的IP地址，使得整个专用网只需要一个全球IP地址，就可以让多台主机同时访问因特网。

5-4-2 分类

（1）静态NAT：一个外网地址对应一个内网地址
（2）动态NAT：一个外网地址对应多个内网地址
（3）NAPT网络地址端口转换：在动态NAT的基础上添加了端口号

5-4-3 NAPT工作机制：

（1）==内网访问公网==（向外发送包时），==修改源地址==和源端口，只有NAPT访问外网；

（2）==公网访问内网==（内网接收包时），==修改目的==地址和目的端口，只有NAPT访问内网；

例：CQWU学院内部某学生的IP地址为10.25.76.84:3306，该同学通过校园地址转换NAT服务器（202.203.116.23:5001），访问136邮箱服务器202.223.196.117:80；请写出该生发送访问访问136邮箱时，包中的源地址IP、端口和目的IP、端口的值，以及结果转换后的源地址IP、端口和目的IP、端口的值；136服务器相应该生请求包中源地址IP、端口和目的IP、端口的值，以及经过转换后的源地址IP、端口和目的IP、端口的值；

解：（1）访问136服务器：转换前：S=10.25.76.84:3306（学生） ；D=202.223.196.117:80（163）；转换后：S=202.203.116.23:5001（NAT服务器）；D=202.223.196.117:80（136）

（2）服务器相应包：转换前：S=202.223.196.117:80（136） ; D=202.203.116.23:5001（NAT服务器）；转换后：S=202.223.196.117:80（136）；D=S=10.25.76.84:3306（学生）



##### 5-5 路由选择算法与分组交付

###### 5-5-1  默认路由器与路由选择

（1）分组交付：是指在互联网中主机、路由器字符IP分组的过程。

（2）默认路由器：局域网通过一个路由器进入到Internet，该路由器就称为默认==路由器（0.0.0.0）==，又称为与第一跳路由器

（3）分组交付的分类
1）直接交付：在同一网络中的主机与路由器（主机）进行IP分组交付的方式
2）间接交付：不同网络中的主机进行IP分组交付方式

（4）路由选择：分组交付的路径有路由选择算法决定；路由选择的核心是路由选择算法

（5）路由算法的评价：
1）算法必须是正确的和完整的
2）算法在计算上应简单
3）算法应能适应通信量和网络拓扑的变化，这就是说，要有自适应性。
4）算法应具有稳定性
5）算法应是公平的
6）算法应是最佳的（不存在绝对的最佳）

（6）路由选择算法分类：
1）静态路由选择策略--即非自适应路由选择（管理员手动配置），其特点是简单和开销较小，但不能及时适应网络状态的变化
2）动态路由选择策略--即自适应路由选择（路由选择算法自动生成），其特点是能较好地适应网络状态的变化，但实现起来较为复杂,，销也比较大

（7）路由表格式：==目的网络 	子网掩码	下一跳地址及端口==

（8）路由收敛：指当路由环境发生变化后，各路由器调整自己的路由表以适应网络拓扑结构的编号，最终达到稳定状态



###### 5-5-2 路由选择协议

（1）路由选择算法与路由协议的区别：
1）路由选择算法：生成路由表，为路由器转发IP分组找到一条合适的下一跳路由器
2）路由选择协议：实现路由表中路由信息的动态更新

（2）自治系统：
1）自治系统的核心是路由选择自治，一个学校、公司等都可以看做一个自治系统
2）自治系统内部采用内部网关协议（IGP）,各个系统之间采用外部网关协议（EGP）

（3）内部网关协议（IGP）分为路由信息协议（RIP）和开放最短路径优先（OSPF）

（4）外部网关协议（EGP）通常采用BGP（边界网关协议）



###### 5-5-3 路由信息协议（RIP）

（1）概念：路由信息协议（RIP）是基于距离向量路由选择算法的内部路由协议

（2）要点：
1）仅和相邻路由器交换信息
2）交换的信息是当前本路由器所知道的全部信息，即自己的路由表
3）按固定的时间间隔交换路由信息,例如,每隔30秒
4）生成时间为==15==，即超过16跳将不可达
5）应用层协议，使用==UDP==传输数据；

###### 5-5-4 开放最短路径优先（OSPF）

（2）特点：网络层协议，直接使用==IP数据报==发送



###### 5-5-5 外部网关协议（EGP）

（1）外部网关协议EGP (External Gateway Protocol)：若源站和目的站处在不同的自治系统中，当数据报传到一个自治系统的边界时，就需要使用一种协议将路由选择信息传递到另一个自治系统中，这样的协议就是外部网关协议EGP。

（2）在外部网关协议中目前使用最多的是BGP-4

（3）BGP: （Border Gateway Protocol）边界网关协议： BGP是不同自治系统的路由器之间交换路由信息的协议。边界网关协议BGP只能是力求寻找一条能够到达目的网络且比较好的路由(不能兜圈子)，而并非要寻找一条最佳路由。

（4）基于路径-向量路由选择协议，使用TCP，寻找的并非最佳路由

- 使用TCP
- 只发送增量路由更新，在建立邻居关系后，路由器会将自己的全部路由信息告知邻居，此后如果路由表发生了变化，只将增量/更新部分发送给邻居
- BGP交换的路由信息是到达某个目的网络所要经过的各个自治系统序列而不仅仅是下一跳





##### 5-5 路由器

（1）概念：就是一台多个输入输出端口的专用计算机，其任务是连接不同的网络（异构网络）并完成路由转发。

（2）功能：==连接异种网路==，路由选择、分组转发（IP数据报），（建立并维护路由表，通提供网间的分组转发功能）

（3）组成：

- 控制部分（路由选择部分）：路由选择处理机，根据路由协议构造与维护路由表
- 分组转发部分：交换结构、一组输入端口和一组输出端口

（4）特点：

- 跨域用来连接异构网络，实现路由转发，==能隔离冲突域和广播域==，依照IP地址转发
- 路由表用软件实现，转发表用软件或硬件实现
  - 路由表具有四个项目：目的网络IP地址、子网掩码、下一跳IP地址、接口
  - 转发表由路由表得出：目的站、下一跳的MAC地址
  - 路由表中==默认路由==的目的地址和子网掩码都是==0.0.0.0==

- 路由器是第三层设备，向传输层即以上层隐藏下层的具体实现，所以物理层、数据链路层、网络层协议可以不同，==而网络层以上的高层协议必须相同==

（5）性能指标：设备和端口吞吐量，路由表能力，丢包率，延时和延时抖动，可靠性、==全双工线速转发能力==（核心）
全双工线速转发能力：是指以最小分组数据长度（Ethernet数据64B、POS数据为40B）和最小分组间隔，在路由器端口上双向传输，在不引起丢包情况下，每秒钟能传输的最大分组数



##### 5-6 ICMP控制报文协议

（1）概念：==用来给主机或路由器报告差错和异常情况，分为差错报告报文和询问报文两类，用于解决IP协议不可靠的问题==

（2）ICMP差错报告报文：

- 终点不可达：当路由器或主机不能交付该数据报时向终点发送
- 源点抑制：拥塞丢弃数据报，向源点发送
- 时间超过：路由器收到生存TTL为零的数据报时，丢弃该数据报并向源点发送该报文
- 参数问题：路由器或主机收到的数据报的首部中有的字段不正确，丢弃并向源点发送该报文
- 改变路由（重定向）：路由器把改变路由报文发送给主机，让主机知道下次应将数据发送给另外的路由器（可通过更好的路由）

（3）ICMP询问报文：

- 回送请求和回答报文（例PING）

- 时间戳请求和回答报文
- 掩码地址请求和回答报文
- 路由器询问和通告报文

（4）不应发送ICMP差错报告报文的几种情况

- 对ICMP差错报告报文不再发送ICMP差错报告报文
- 对第一个分片的数据报片的所有后续数据报片都不发生ICMP差错报告报文
- 对具有组播地址的数据报都不发送ICMP差错报告报文
- 对具有特殊地址（如127.0.0.0或0.0.0.0）的数据报不发送ICMP差错报告报文

###### 5-6-1 ping命令

（1）作用：测试网路的连通性

（2）格式：ping IP地址/域名

（3）使用ICMP回送请求和回答报文，==工作在应用层==

###### 5-6-2 tracert 路由跟踪命令

（1）作用：记录从源主机到目的主机所经历的路由器

（2）使用ICMP时间超过报文，==工作在网络层==

###### 5-6-3 常用命令

ipconfig (linux: ifconfig) (显示TCP/IP网络配置值,如: IP地址, MAC地址,网关地址等) 

tracert (linux: traceroute) ：用于确定IP数据包访问目标所采取的路径，若网络不通，能定位到具体哪个结点不通

netstat：用于显示网络连接、路由表和网络接口信息

nslookup ：查询DNS记录

##### 5-7 地址解析协议（RAP）

（1）功能：将IP地址解析成对应的MAC地址

（2）每个主机都设有一个ARP高速缓存，存放ARP表（本局域网上各主机和路由器的IP地址到MAC地址的映射表），并使用ARP协议动态维护

（3）ARP==**请求分组是广播**==发送的，ARP**==响应分组是单播==**（即一个源地址发送到一个目的地址）

在通信过程中，IP 数据报的源地址和目的地址始终不变，而 MAC 地址随着链路的改变而改变

（4）工作原理：

1. 主机A打算向本局域网的主机B发送IP数据报；
2. 先查找ARP表中是否有B的IP地址，如果有，就能查出MAC地址，完成传输；
3. 如果ARP表中没有，主机A发送MAC地址为FF-FF-FF-FF-FF-FF的帧广播ARP请求分组；
4. 主机B收到该ARP请求后，会想主机A发送响应ARP，分组中包含B的IP与MAC地址映射关系
5. A收到该映射关系后，写入A的ARP表中，然后按照查到的MAC地址，发送MAC帧

（5）RARP：反向地址解析协议

##### 5-8 IP多播（IGMP）

（1）概念：在发送者和每一接收者之间实现点对多点网络连接，应用==UDP==协议，使用==D类地址==

（2）要点：

- D类地址（即组播地址）范围：224.0.0.0 ~ 239.255.255.255
- IGMP协议：使路由器知道组播成员的信息
- 避免路由环路：构造组播转发树

##### 5-9 移动IP

（1）概念：支持移动性的因特网体系结构，移动节点以固定的网络IP地址，实现跨不同网段的漫游功能

（2）组成：移动结点、本地代理、外部代理

（3）主机离开归属地时，既不能直接接收分组，也不能直接发送分组，通过交换地址来间接接收和发送分组。



##### 5-10 IPv6技术

（1）产生原因：解决IPv4地址即将枯竭的状况

（2）表示方法：128位二进制数，16位（两个字节）为一位段，每个位段转换成4位16进制数，用冒号分隔（冒号十六进制分隔）

（3）零压缩法：

- 省略前导零：`1050:0000:0000:0000:0005:0600:300c:326b`可表示为`1050:0:0:0:5:600:300c:326b`
- 通过使用双冒号 (::) 代替一系列零来指定IPv6地址：`1A22:120D:0000:0000:72A2:0000:0000"00C0`可表示为 `1A22:120D::72A2:0000:0000:00C0`

- 注意：双冒号 (::) 在一个地址中只能出现一次，也就是说有多处相邻的0时，只能用 (::) 代表其中一处

（4）特点：

- 更大的地址空间，128位，IPv4为32位，==表示范围是IPv4的2^96^倍==
- 扩展的地址层次结构
- 灵活的首部格式
- 改进的选项
- 允许协议继续扩充
- 支持即插即用（即自动配置）
- 支持资源的预分配
- IPv6只有在包的源结点才能分片，是端到端的，传输路径中的路由器不能分片，所以在一般的意义上讲，==IPv6不允许分片==
- 增加安全性
- 不提供校验和字段





#### 6 传输层

##### 6-1 提供服务

（1）提供服务：

- 进程之间的逻辑通信（即端到端通信）
- 复用和分用
- 差错检测（首部和数据部分）
- 面向连接的TCP和无连接的UDP

（2）==数据链路层的SAP（Service Access Point）是MAC地址；网络层的SAP是IP地址；传输层的SAP是端口==

##### 6-2 进程端口套接字

###### 6-2-1 套接字

套接字（socket）=主机IP地址/域名：端口号；唯一标识了网络中的一个主机和其上的一个应用（进程）

###### 6-2-2 端口号分类

（1）==熟知端口（公认端口）：0-1023==，有IANA同一分配

（2）==注册端口：1024-49151==

（3）==临时端口：49152-65535==

###### 6-2-3 使用UDP的熟知端口

| 端口号 | 服务进程 |            说明            | 端口号  | 服务进程 |            说明            |
| :----: | :------: | :------------------------: | :-----: | :------: | :------------------------: |
|   53   |   DNS    |   域名解析服务（应用层）   | 161/162 |   SNMP   | 简单网络管理协议（应用层） |
| 67/68  |   DHCP   | 动态主机配置协议（应用层） |   520   |   RIP    |   路由管理协议（应用层）   |
|   69   |   TFTP   | 简单文件传输协议（应用层） |         |          |                            |

###### 6-2-4 使用TCP的熟知端口

| 端口号 | 服务进程 |                说明                | 端口号 | 服务进程 |          说明          |
| :----: | :------: | :--------------------------------: | :----: | :------: | :--------------------: |
|   20   |   FTP    | 文件传输协议（数据连接）（应用层） |   25   |   SMTP   | 简单邮件传输协议（发） |
|   21   |   FTP    | 文件传输协议（控制连接）（应用层） |   80   |   HTTP   |     超文本传输协议     |
|   23   |  TELNET  |       远程登录协议（应用层）       |  179   |   BGP    |      边界路由协议      |

###### 6-2-5 多重协议的识别

（1）三元组：协议，本地地址，端口号；ftp://192.168.10.10:8092

（2）五元组：协议，本地地址，端口号，远程地址，远程端口号；ftp://192.168.10.10:8092,202.201.23.25:8080



##### 6-3 TCP协议传输控制协议

###### 6-3-1 特点

- 支持面向连接的传输服务
- 支持字节流的传输
- 支持全双工
- 支持同时建立多个并发的TCP连接
- 支持可靠的传输服务

###### 6-2-3 TCP报文格式

<img src="%E5%9B%BE%E7%89%87/image-20210423195735902.png" alt="image-20210423195735902" style="zoom:80%;" />

（1）各字段含义

- 序号：第一个字节的序号
- 确认号：是指期望收到对方的下一个报文段的数据的第一个字节的序号
- URG：紧急位，为1时优先级高，配合紧急指针使用
- ACK：确认位，在建立连接后ACK都要置为1
- PSH：推送位，置为1时，希望对方尽快应答
- RST：复位位，置为1时，表示由于主机崩溃等原因造成TCP连接出错，需要释放联解；拒绝非法连接
- SYN：同步位，在连接时同步序号，SYN=1、ACK=0表示这是一个连接请求报文；SYN=1、ACK=1表示这是一个同意连接的响应报文
- FIN：终止位，FIN=1表示发送端的报文段发送完毕，请求释放连接

###### 6-2-3 TCP的连接

（1）简称：三次握手，客服端发起连接，服务器接收连接

（2）过程：

1. 客户端→服务器：SYN=1，SEQ=x（随机产生不为0）：建立连接请求报文
2. 服务器→客户端：SYN=1，ACK=1，SEQ=y（随机产生不为0），ack=x+1（对x进行确认）：连接建立请求确认报文
3. 客户端→服务器：ACK=1，SEQ=x+1（规定），ack=y+1（对y进行确认）：连接建立请求确认报文

###### 6-2-4 TCP的释放

（1）简称：四次挥手

（2）过程：

1. 客户端→服务器：FIN=1,ACK=1,SEQ=x：连接释放请求报文
2. 服务器→客户端：ACK=1,SEQ=v,ack=x+1：连接释放请求确认报文
3. 服务器→客户端：ACK=1,SEQ=v,ack=x+1：连接释放请求报文（与上一个相同）
4. 客户端→服务器：FIN=1,ACK=1,SEQ=x,ack=ack=x+1+1:连接释放请求确认报文

###### 6-2-5 TCP的流量控制

（1）TCP的流量控制使用==滑动窗口==机制实现

（2）接收端缓存剩余空间→（决定）接收窗口→（决定）发送窗口

（3）发送窗口长度=已发送但未确认+尚未发送但接收端做好准备接收

（4）可用窗口=尚未发送但接收端做好准备接收

（5）重传机制：==ARQ自动请求重传协议==

- 拉回穿重传：出错点以后的数据全部重传
- 选择重传：只重传错误的数据

###### 6-2-6 TCP适用场景

（1）对数据的实时性要求不高的情况

（2）对数据的精确性要求很高的情况



##### 6-4 UDP用户数据报协议

（1）特点：

- 是一种无连接的协议（尽力而为）
- 是一种面向报文的传输层协议

（2）适用场景

- 视频播放
- 简短的交互式应用
- 多播与广播





#### 7 应用层

##### 7-1 C/S模式与P2P模式

（1）C/S模式：客户端/服务器，以服务器为中心

（2）P2P模式：对等网模式，无中心



##### 7-2 DNS域名系统

###### 7-2-1 DNS域名系统

（1）作用：将域名转换成IP地址

（2）特点：

- 计算机用户间接适用DNS

- 使用UDP向域名服务器传输DNS请求报文

- 结构：采用层次树状结构，域名只是逻辑概念

- 域名服务器:以区为管辖单位，根域名服务器一顶级域名服务器(TLD)一权限域名服务器一本地域名服务器

- 域名解析过程：
  1）递归查询：主机向本地域名服务器的查询采用递归查询，（请求者身份向上递归）

  2）迭代查询：本地域名服务器向根域名服务器的查询采用迭代查，(常用）

- 高速缓存:本地域名服务器和主机都会有;有计时器（增加时间减少网络开销，减少时间提高域名转换的准确性）

###### 7-2-2 域名

（1）常用域名：

- .com：商业
- .edu：教育机构
- .gov：政府机构
- .net：网路服务提供商
- .org：非营利性组织
- .int：国际性组织
- .mil：军事组织

（2）域名：从后往前，范围越来越小，http ://www .cqwu.edu.cn



##### 7-3 TELNET远程登录协议

（1）NVT：网路虚拟终端

（2）使用TCP协议，占用23端口

##### 7-4 电子邮件

###### 7-4-1 电子邮件

（1）邮件发送协议: SMTP

（2）取邮件的协议: POP3和IMAP

（3）MIME（通用因特网扩充）在其邮件首部中说明了邮件的数据类型（如文本、声音、图像、视像等），使用MIME可在邮件中同时传送多种类型的数据。

（4）电子邮件的最主要的组成构件：用户代理、发送端邮件服务器、接收端邮件服务器

- 用户代理UA就是用户与电子邮件系统的接口，是电子邮件客户端软件



###### 7-4-2 SMTP简单邮件传输协议

（1）用于==发送邮件==

（2）使用TCP协议，占用25端口

（3）格式：smtp.sina.com.cn

（4）三个阶段：建立连接，发送邮件，释放连接



###### 7-5-3 POP3邮局协议

（1）用于接收邮件

（2）使用TCP协议，占用110

（3）POP也使用客户/服务器的工作方式，在接收邮件的用户PC机中必须运行POP客户程序，而在用户所连接的ISP的邮件服务器中则运行POP服务器程序

（4）IMAP因特网报文存取协议：也是按客户服务器方式工作，现在较新版本4,即IMAP4

（5）用户在自己的PC机上就可以操纵ISP (Internet Service Provider) 的邮件服务器的邮箱，就像在本地操纵一样。因此IMAP是一个联机协议。当用户PC机上的IMAP客户程序打开IMAP服务器的邮箱时，用户就可看到邮件的首部。若用户需要打开某个邮件,则该邮件才传到用户的计算机上

（6）IMAP的特点允许收件人只读取邮件中的某一个部分

###### 7-5-4 发送接收电子邮件过程

（1）发件人调用PC机中的用户代理撰写和编辑要发送的邮件

（2） 发件人的用户代理把邮件用SMTP协议发给发送方邮件服务器

（3） SMTP服务器把邮件临时存放在邮件缓存队列中,等待发送

（4）发送方邮件服务器的SMTP客户与接收方邮件服务器的SMTP服务器建立TCP连，接,然后就把邮件缓存队列中的邮件依次发送出去

（5）运行在接收方邮件服务器中的SMTP服务器进程收到邮件后，把邮件放入收件人的用户邮箱中，等待收件人进行读取

（6）收件人在打算收信时，就运行PC机中的用户代理,使用POP3 (或IMAP)协议读取发送给自己的邮件

（7）请注意，POP3服务器和POP3客户之间的通信是由POP3客户发起的

###### 7-5-5 MIME通用因特网邮件扩充

（1）MIME的特点：MIME并没有改动SMTP或取代它，MIME的意图是继续使用目前的[RFC 822]格式，但增加了邮件主体的结构，并定义了传送非ASCII码的编码规则



##### 7-5 DHCP动态主机配置协议

（1）动态主机配置协议DHCP提供了==即插即用连网==(plug-and-play networking)的机制，这种机制允许一台计算机加入新的网络和获取IP地址而不用手工参与

（2）使用UDP协议，占用67/68端口

（3）DHCP使用客户服务器方式：

- 需要IP地址的主机在启动时就向DHCP服务器广播发送发现报文(DHCPDISCOVER)，这时该主机就成为DHCP客户；
- 本地网络上所有主机都能收到此广播报文，但只有DHCP服务器才回答此广播报文。
- DHCP服务器先在其数据库中查找该计算机的配置信息，若找到，则返回找到的信息；若找不到，则从服务器的IP地址池(address pool)中取一个地址分配给该计算机；
- DHCP服务器的回答报文叫做提供报文(DHCPOFFER)

（4）DHCP中继代理(relay agency)：

并不是每个网络上都有DHCP服务器,这样会使DHCP服务器的数量太多，现在是每一个网络至少，有一个DHCP中继代理，它配置了DHCP服务器的IP地址信息；当DHCP中继代理收到主机发送的发现报文后，就以单播方式向DHCP服务器转发此报文，并等待其回答，收到DHCP服务器回答的提供报文后，DHCP中继代理再将此提供报文发回给主机

（5）租用期(lease period)：

- DHCP服务器分配给DHCP客户的IP地址的临时的，因此DHCP客户只能在一段有限的时间内使用这个分配到的IP地址，DHCP协议称这段时间为租用期
- 租用期的数值应由DHCP服务器自己决定；DHCP客户也可在自己发送的报文中(例如，发现报文)提出对租用期的要求



##### 7-6 HTTP超文本传输协议

###### 7-6-1 统一资源定位器URL

（1）组成：协议类型：// 主机名[域名/IP地址] : 端口号 /路径及文件

###### 7-6-2 HTTP超文本传输协议

（1）基于TCP协议，占用80端口

（2）特点：

- 无状态协议：同一个会话下的多个请求是相互独立的，服务器不知道（不记忆）两个请求是否来自同一个会话

- 非持续性和持续性：

  非持续性：客户机向服务器发送多个服务请求报文时，服务器需要对每个请求进行应答，并为每一个应答过程建立一个TCP连接的工作方式，称之为非持续性。HTTP1.0为非持续性

  持续性：客户机与服务器的请求与应答报文都可以通过一个TCP连接来完成的工作方式称之为持续性。HTTP1.1为持续性

（3）流水线方式：客户端没有收到前一个响应时就能够发出新的请求

（4）报文类型

- 请求报文：三部分:方法，URL，HTTP版本

  方法：GET:数据明文传输；POST:数据暗文传输

- 应答报文：三部分：状态行，报头，正文



##### 7-7 FTP文件传输协议

（1）文件传送协议FTP只提供文件传送的一些基本的服务，它使用TCP可靠的运输服务，占用20（数据连接），21（控制连接）端口

（2）FTP的主要功能是减少或消除在不同操作系统下处理文件的不兼容性

（3）两大部分

- 主进程，接受新请求；
- 另外有若干个从属进程，负责处理单个请求

（4）两个并行连接

- 控制连接（21端口），在整个会话期间一直保持打开, FTP客户发出的传送请求通过控制连接发送给服务器端的控制进程，但控制连接不用来传送文件
- 数据连接（20端口），实际传输文件，用来连接客户端和服务器端的数据传送进程



7-8 TFTP简单文件件传输协议

（1）使用UDP数据报，端口号69

（2）只支持文件传输，不支持交互:

（3）特点：

- 每次传送的数据PDU中有512字节的数据，但最后一次可不足512字节(文件结束的标志,若是512的整数倍则发一个只有首部的数据报文)

- 数据PDU也称为文件块(block)，每个块按序编，从1开始

- 支持ASCII码或二进制传送

- 可对文件进行读或写

- 使用很简单的首部

  

##### 7-9 CGI通用网关接口

（1）CGI(Common Gateway Interface)通用网关接口，是一种标准，它定义了动态文档应如何创建，输入数据应如何提供给应用程序，以及输出结果应如何使用。

（2）万维网服务器与CGI的通信遵循CGI标准。

- “通用": CGI标准所定义的规则对其他任何语言都是通用的。
- “网关": CGI程序的作用像网关。
- “接口”:有一些已定义好的变量和调用等可供其他CGI程序使用。



##### 7-10 即时通信与会话初始化

###### 7-10-1 即时通信与会话初始化

（1）分类：

- 在线的对等通信方式
- 离线的中转通信方式

（2）协议：会话初始化协议SIP

（3）代理分类

1. 用户代理
   - 用户代理客户：发起服务
   - 用户代理服务器：接收服务
2. 网络服务器
   - 代理服务器（SIP路由器）：接受用户代理客户发出的呼叫请求，并将它转发给被叫用户或下一跳的代理服务器，然后由下一跳的代理服务器呼叫请求转发给用户代理服务器。
   - 注册服务器：接收和处理代理请求，完成用户地址注册过程
   - 重定向服务器：不接收用户呼叫请求，只处理SIP呼叫路由





#### 8 网络安全

##### 8-1 计算机网络面临的安全威胁

###### 8-1-1 计算机网络面临的安全威胁

（1）计算机网络面临的安全威胁：

1. 截获——从网络上窃听他人的通信内容

2. 中断 ——有意中断他人在网络上的通信

3. 篡改——意篡改网络送的报文

4. 伪造——伪造信息在网络上传

   截获信息的攻击称为被动攻击，而更改信息和拒绝用户便用资源的击称主动攻击

（2）被动攻击与主动攻击

- 被动攻击——被动攻击是对信息的保密性进行攻击，即通过窃听网络上传输的信息并加以分析从而获得有价值的情报，但它并不修改信息的内容。它的目标是获得正在传送的信息，其特点是偷听或监视信息的传递。被动攻击只对信息进行监听，不对其进行修改。被动攻击包括信息内容泄露和业务流分析两大类具体有：

  -  窃听。信息在通信过程中因被监视窃听而泄露。 

  - 电磁/射频截获。信息从电子或机电设备所发出的无线电磁波中被提取出来。 

  - 业务流分析。通过观察通信业务流模式，使非授权实体（人或系统）获得信息等。

    

- 主动攻击——主动攻击是攻击信息来源的真实性、信息传输的完整性和系统服务的可用性的体现，有意对信 息进行修改、插入和删除。主动攻击包括篡改数据流或伪造数据流，这种攻击试图改变系统资源或影响系统运行，主动攻击它主要包括： 

  - 截获/修改。某一通信数据在传输过程中被改变、插入和替代。 
  - 重放。把所截获的某次合法通信数据进行复制，出于非法目的重新发送。
  - 伪装。某个实体假装成另一个实体，并获取该实体的权限。 
  - 非法使用。某一资源被某个非授权实体或以某一非授权方式使用。 
  - 服务拒绝。攻击者通过对系统进行非法和根本无法成功的访问尝试而产生过量的负荷，使合法用户的访问被无条件地被阻止。
  - 特洛伊木马。含有一个觉察不出或无害程序段的软件，当它被运行时，能损害系统的安全。 
  - 陷门。在某个系统或其部件中设置"机关",使在提供特定的输入数据时发生违反安全策略的 操作等。

  

（3）计算机网络通信安全的目标：

1. 防止析出报文内容；
2. 防止通信量分析；
3. 检测更改报文流；
4. 检测拒绝报文服务；
5. 检测伪造初始化连接

（4）恶意程序：

- 算机病毒——会“传染”其他程序的程序,，“传染”是通过修改其他程序来把自身或其变种复制进去完成的
- 计算机蠕虫——通过网络的通信功能将自身从一个结点发送到另一个结点并启动运行的程序
- 洛伊木马——一种程序，它执行的功能超出所声称的功能
- 逻辑炸弹——一种当运行环境满足某种特定条件时执行其他特殊功能的程序

（5）计算机网络安全的内容：

- 保密性
- 安全协议的设计
- 访问控制

（6）五类网络安全服务

- 认证：数据的机密性(保密性)是指数据在传输过程中不能被非授权者偷看
- 访问控制：可用性指的是发送者和接受者双方的通信方式正常。
- 数据机密性：数据的真实性(不可抵赖性)是指信息的发送者身份的确认或系统中有关主体的身份确认,这样可以保证信息的可信度
- 数据完整性：数据的完整性是指数据在传输过程中不能被非法篡改
- 防抵赖



###### 8-1-2 常见的网络攻击

（1）常见的网络攻击有对加密算法的攻击、网络监听、拒绝服务攻击、远程攻击、系统攻击等。

- 对加密算法的攻击

  对加密算法的攻击主要集中于破译某段密文或分析加密密钥。通常破译者可对密码进行惟密文 攻击、已知明文攻击、选择密文攻击和选择明文攻击及穷举攻击，对特定算法还有特定攻击方法， 如对DES这类迭代分组密码可选择差分密码分析法、能量攻击法，对公钥算法RSA可采用公用模攻击、低加密指数攻击、定时攻击等方法。

- 网络监听

  网络监听是主机的一种工作模式，在这种模式下，主机可以接收到本网段在同一条物理信道上 传输的所有信息，而不管信息的发送方和接收方是谁。所以进行通信的信息必须进行加密，否则只 要使用一些网络监听工具就可以截获包括口令和账号在内的信息资料。大部分的传输介质如 Ethernet、FDDI、Token-ring、模拟电话线、无线接入网上都可实施网络监听，其中尤以Ethernet 与无线接入网最为容易，因为这两者都是典型的广播型网络

- 拒绝服务攻击

  拒绝服务攻击（DoS）有些是用来消耗带宽的，有些是消耗网络设备的CPU和内存 的。例如对UDP的攻击，原理就是使用大量的伪造的报文攻击网络端口，造成服务器的资源耗尽， 使系统停止响应甚至崩溃。也可以使用大量的IP地址向网络发出大量真实的连接，来抢占带宽，造成网络服务的终止

  - 一是试图破坏资源，使目标无人可以使用此资源。如破坏或摧毁信息： 删除文件、格式化磁盘、切断电源等。
  - 二是过载一些系统服务或者消耗一些资源，通过这样的方式 可以造成其它用户不能使用这个服务。这两种情况大半是因用户错误或程序错误造成的，并非针对性的攻击。针对网络的拒绝服务攻击主要包括服务过载攻击、消息流攻击、Paste式攻击、SYN Flooding攻击、邮件炸弹攻击。
  
  ==分布式拒绝服务（DDoS）==攻击通过探测扫描大量主机，从而找到可以入侵的目标主机，通过一 些远程溢出漏洞攻击程序，入侵有安全漏洞的目标主机并获取系统的控制权，在被入侵的主机上安 装并运行DDoS分布式的攻击守护进程，然后利用多台已被攻击者控制的机器对另一台单机进行扫描 和攻击，在大小悬殊的带宽之比下被攻击的主机很快失去反应能力。整个过程都是自动化的，攻击 者可以在几秒钟内入侵一台主机并安装攻击工具，这样，在一个小时之内就可以入侵数千台主机
  
- 远程攻击

  远程攻击指在目标主机上没有账户的攻击者获得该机器的当地访问权限，从机器中过滤出数 据、修改数据等的攻击方式。远程攻击的一般过程如下： 

  - 收集被攻击方的有关信息，分析被攻击方可能存在的漏洞。
  - 建立模拟环境，进行模拟攻击，测试对方可能的反应。
  - 利用适当的工具进行扫描。 
  - 实施攻击

  ==IP Spooting是一种典型的远程攻击==，它通过向主机发送IP包来实现攻击，主要目的是掩盖攻击者的真实身份，使攻击者看起来像正常的用户或者嫁祸于其他用户。IP Spooting攻击利用了RPC服务器仅仅依赖于信源IP地址进行安全校验的特性，攻击最困难的地方在于预测A的ISN

- 系统攻击

  （1）概念：系统攻击指一台机器上的本地用户获取UNIX高级用户权限或Windows NT管理员权限的攻击方 法。缓冲区溢出是典型系统攻击。它通过向程序的缓冲区写超出其长度的内容，造成缓冲区溢出， 从而破坏程序的堆栈，使程序转去执行其它的指令，如果这些指令是放在有Root权限的内存里，那 么，一旦这些指令得到了运行，入侵者就以Root的权限控制了系统。造成缓冲区溢出的原因大多是 程序没有仔细检查用户输入的参数。缓冲区溢出攻击占所有系统攻击的80%以上

  （2）目的：一是在程序的地址空间里安排适当的代码；二是通过 适当地初始化寄存器和存储器，让程序跳转到安排好的地址空间执行，可以根据这两个任务对缓冲区溢出攻击进行分类：

  - 在程序的地址空间里安排适当的代码的方法 
  - 将控制程序转移到攻击代码的方法 
  - 植入综合代码和流程控制技术

  （3）解决方案：通常可以采用下列方法防止缓冲区溢出：

  - 正确地编写代码 
  - 设定非执行的缓冲区
  - 检查数组边界，使之不溢出
  - 检查程序指针的完整性

  

##### 8-2 数据加密技术

###### 8-2-1 数据加密技术

（1）概念：数据加密和数据解密是一对可逆的过程，数据加密是用加密算法E和加密密钥K1将明文P变换成 密文C.数据解密是数据加密的逆过程，用解密算法D和解密密钥K2,将密文C转换在明文P.

（2）**数据传输加密**

数据传输加密技术的目的是对传输中的数据流加密，以防止通信线路上的窃听、泄露、篡改和 破坏。

链路加密侧重于在通信链路上而不考虑信源和信宿，是对保密信息通过各链路采用不同的加密 密钥提供安全保护。



###### 8-2-1 对称加密

（1）概念：对信息加密和解密都是用相同的秘钥

（2）代表算法：

- DES（data encryption standard）数据加密标准

- MD5

- IDEA算法

- RC2算法

- RC4算法

- Skipiack算法

（3）MD5（Message Digest ver5）是可产生一个 128 位的散列值的散列算法，可以用于生成数字摘要

（4）==RC-5加密效率高，适合于加密大量的数据==



###### 8-2-2 非对称加密

（1）概念：对信息加密与解密使用不同的秘钥

（2）代表算法：

- RSA算法
- DSA算法
- PKCS算法
- PGP算法

###### 8-2-3 公钥密码体制（RSA）

8-2-3-1 概念：公钥密码体制使用不同的加密密钥与解密密钥，一种” 由已知加密密钥推导出解密密钥在计算上是不可行的 “密码体制，RSA（Rivest-Shamir-Adleman）算法密钥长度为512位，其保密性取决于数学上将一个大数分解为两个素数的问题的难度，根据已有的数学方法，其计算量极大，破解很难。

8-2-3-2  公钥和私钥：

（1）在公钥密码体制中，加密密钥（即公钥） PK (Public Key) 是公开信息，而解密密钥（即私钥或秘钥）SK(Secret Key)是需要保密的

（2）加密算法E(Encrypt)和解密算法D也都是公开的

（3）虽然秘钥SK是由公钥PK决定的，但却不能根据PK计算出SK

8-2-3-3 公钥算法的特点

- 发送者==A用B的公钥PKB对明文x加密(E运算)后，在接收者B用自己的私钥SKB解密(D运算)，即可恢复出明文==
- 解密密钥是接收者专用的秘钥，对其他人都保密。
- ==加密密钥是公开的，但不能用它来解密==
- 加密和解密的运算可以对调，
- 在计算机上可容易地产生成对的PK和SK
- 从已知的PK实际上不可能推导出SK，即从PK到SK是“计算上不可能的"
- 加密和解密算法都是公开的

8-2-3-4 ==ECC==（Elliptic Curve Cryptography，椭圆曲线密码）也是非对称密码，加解密使用不同的密钥 （公钥和私钥），它们对计算资源的消耗较大，==适合加密非常少量的数据==，==例如加密会话密钥==



##### 8-3 数字签名

（1）==保证真实性，防抵赖==

（2）数字签名必须保证以下三点：

- 报文鉴别——接收者能够核实发送者对报文的签名

- 报文的完整性——发送者事后不能抵赖对报文的签名

- 不可否认——接收者不能伪造对报文的签名

  现在已有多种实现各种数字签名的方法，但采用==公钥算法==（非对称加密）更容易实现

（3）数字签名的实现：

- 因为除A外没有别人能具有A的私钥，所以除A外没有别人能产生这个密文
- 因此B相信报文是A签名发送的。若A要抵赖曾发送报文给B，B可将明文和对应的密文出示给第三者。第三者很容易用A的公钥去证实A确实发送x给B
- 反之，若B将伪造成x，则B不能在第三者前出示对应的密文，这样就证明了B伪造了报文。

###### 8-3-2  Kerberos

在分布式网络应用环境中，要保证其使用的安全性，就必须让工作站能够用可信、安全的方式 向服务器证实其身份，否则就会出现许多安全问题。而解决这个问题的技术称之为身份认证。比较 常见的身份认证技术包括：用户双方指定共享密钥（最不安全）、使用智能卡生成密钥、使用 Kerberos服务、使用PKI服务（即通过从CA中心获取数字证书的方式）。

 Kerberos并非为每一个服务器构造一个身份认证协议，而是提供一个中心认证服务器，提供用 户到服务器以及服务器到用户的认证服务。Kerberos的核心是使用DES加密技术，实现最基本的认证服务。Kerberos采用了连续加密的机制来防止会话被劫持。 Kerberos认证过程可以分为3个阶段，6个步骤： 

第一阶段：认证服务交换、客户端获取授权服务器访问许可票据。 

1. 用户A输入自己的用户名，以明文的方式发给认证服务器。 
2. 认证服务器返加一个会话密钥KS和一个票据KTGS（A，KS），这个会话密钥是一次性的 （也可以使用智能卡生成），而这两个数据包则是使用用户A的密钥加密的，返回时将要求其输入密码，并解密数据

 第二阶段：票据许可服务交换，客户端获得应用服务访问许可票据。 

​	3.用户A将获得的票据、要访问的应用服务器名B,以及用会话密钥加密的时间标记（用来防 止重发攻击）发送给授权服务器（TGS）。 .

​	4.授权服务器（TGS）收到后，返回A和B通信的会话密钥，包括用A的密钥加密的，和B的 密钥加密的会话密钥KAB. 

第三阶段：客户端与应用服务器认证交换，客户端最终获得应用服务 

​	5.用户A将从TGS收到的用B的密钥加密的会话密钥发给服务器B,并且附上用双方的会话密钥 KAB加密的时间标记以防止重发攻击。 	6	6.服务器B进行应答，完成认证过程。



##### 8-4 鉴别

（1）在信息的安全领域中，对付==被动攻击==的重要措施是==加密==，而对付==主动攻击==中的篡改和伪造则要用==鉴别==（authentication）

（2）报文鉴别使得通信的接收方能够验证所收到的报文（发送者和报文内容、发送时间、序列等）的真伪

（3）使用加密就可达到报文鉴别的目的，但在网络的应用中，许多报文并不需要加密。应当使接收者能用很简单的方法鉴别报文的真伪

- 鉴别的手段：
  - 报文鉴别（使用报文摘要MD (Message Digest）算法与数字签名相结合
  - 实体鉴别

##### 8-5 运输层安全协议,

###### 8-5-1 安套接层SSL(Secure Socket Layer)

（1）SSL可对万维网客户与服务器（http协议）之间传送的数据进行==加密==和==鉴别==

（2）SSL在双方的联络阶段协商将使用的加密算法和密钥，以及客户与服务器之间的鉴别

（3） 在联络阶段完成之后，所有传送的数据都使用在联络阶段商定的会话密钥

（4） SSL不仅被所有常用的浏览器和万维网服务器所支持，而且也是运输层安全协议TLS (Transport  Layer Security)的基础。

- SSL位于传输层与应用层之间
- SSL三个功能：
  1. SSL服务器鉴别 允许用户证实服务器的身份。具有SSL功能的浏览器维持一个表，上面有一些可信赖的认证中心CA (Certificate Authority)和它们的公钥。
  2. 加密的SSL会话  客户和服务器交互的所有数据都在发送方加密，在接收方解密
  3.  SSL客户鉴别 允许服务器证实客户的身份



###### 8-5-2 安全电子交易SET (Secure Electronic Transaction)

（1）概念：安全电子交易SET是专为在因特网上进行==安全支付卡交易==的协议

（2）特点：

- SET是专为与支付有关的报文进行加密的
- SET协议涉及到三方，即==顾客、商家和商业银行==，所有在这三方之间交互的==敏感信息都被加密==
- SET要求这==三方都有证书==，在SET交易中，商家看不见顾客传送给商业银行的信用卡号码



##### 8-6 防火墙（firewall）

（1）概念：

- 防火墙是由==软件==、==硬件==构成的系统,是一种==特殊编程的路由器==，用来在两个网络之间实施接入控制策略
- 接入控制策略是由使用防火墙的单位自行制订的，为的是可以最适合本单位的需要
- 防火墙内的网络称为“==可信赖的网络==” (trusted network)，而将外部的因特网称为“==不可信赖的网络==" (untrusted network)，
- 防火墙可用来解决==内联网==和==外联网==的安全问题

（2）防火墙功能

1. 防火墙的功能防火墙的功能有两个：==阻止==和==允许==，“阻止”就是阻止某种类型的通信量通过防火墙(从外部网络到内部网络，或反过来)
2. “允许”的功能与“阻止”恰好相反，防火墙必须能够识别通信量的各种类型，不过在大多数情况下防火墙的主要功能是“阻止”.

（3）防火墙技术的分类：

1. ==网络级防火墙==——用来防止整个网络出现外来==非法的入侵==，属于这类的有==分组过滤和授权服务器==。前者检查所有流入本网络的信息，然后拒绝不符合事先制订好的一套准则的数据，而后者则是检查用户的登录是否合法。
2. ==应用级防火墙==——从应用程序来进行接入控制，通常使用应用==网关或代理服务器==来区分各种应用。例如,可以只允许通过访问万维网的应用，而阻止FTP应用的通过

（4）防火墙另一种分类

1. 包过滤防火墙：包过滤防火墙也称为==访问控制表或屏蔽路由器==。它根据定义好的过滤规则审查每个数据包并根据是否与规则匹配来决定是否能够通过

2. 双穴主机：双穴主机也称为双宿网关防火墙，它是由一台至少装有两块网卡的堡垒主机作为防火墙，位于内外网络之间，分别与内外网络相离，实现物理上的隔开。它有两种服务方式：一种是用户直接登 录到双宿主机上；另一种是在双宿主机上运行代理服务器。 

   双宿网关防火墙的优点是：

   - 安全性比屏蔽路由器高
   - 缺点是入侵者一旦得到双穴主机的访问权， 内部网络就会被入侵，因此需具有强大的身份认证系统，才可以阻挡来自外部的不可信网络的非法入侵

3. 屏蔽主机防火墙：屏蔽主机防火墙强迫所有外部主机与一个堡垒主机相连接，而不让它们直接与内部主机相连接。它是由包过滤路由器和堡垒主机组成的。 屏蔽主机防火墙的优点是因为它实现了网络层安全（包过滤）和应用层安全（代理），因此安 全等级比屏蔽路由器要高。缺点是堡垒主机可能被绕过，堡垒主机与其他内部主机间没有任何保护 网络安全的东西存在，一旦被攻破，内网就将暴露。

4. 屏蔽子网防火墙

（4）防火墙的缺陷

1. 不能防范外部的刻意的人为攻击
2. 不能防范内部用户的攻击
3. 不能防范内部用户因误操作而造成的口令失密受到的攻击
4. 很难防止病毒或受病毒感染的文件的传输



##### 8-7  入侵检测

（1）概念：入侵检测是指监视或在可能的情况下阻止入侵者试图控制自己的系统或网络资源的那种努力。 它是用于检测任何损害或企图损害系统的机密性、完整性或可用性的行为的一种网络安全技术。它 通过监视受保护系统的状态和活动，采用异常检测或误用检测的方式，发现非授权的或恶意的系统 及网络行为，为防范入侵行为提供有效的手段。

（2）要解决的基本问题

- 如何充分并可靠地提取描述行为特征的数据，

- 如何根据特征数据，高效并准确地判断行为的性质。

通常包括数据源（原始数据）、分析引擎（通过异常检测或误用检测进行分析）、响应（对分析结果采用必要和适当的措施）三个模块。

（4） ==入侵检测系统所采用的技术可分为特征检测与异常检测两种==。 

1. 特征检测。假设入侵者活动可以用一种模式来表示，系统的目标是检测主体活动是否符合 这些模式。它可以将已有的入侵方法检查出来，但对新的入侵方法无能为力。其难点在于如何设计 模式既能够表达"入侵"现象又不会将正常的活动包含进来。 
2. 异常检测。假设入侵者活动异常于正常主体的活动。根据这一理念建立主体正常活动 的"活动简档",将当前主体的活动状况与"活动简档"相比较，当违反其统计规律时，认为该活动可能 是"入侵"行为。异常检测的难题在于如何建立"活动简档"以及如何设计统计算法，从而不把正常的操 作作为"入侵"或忽略真正的"入侵"行为。 

（5）==入侵检测系统常用的检测方法有特征检测、统计检测与专家系统==。

1. 特征检测。对已知的攻击或入侵的方式作出确定性的描述，形成相应的事件模式。当被审 计的事件与已知的入侵事件模式相匹配时，即报警。原理上与专家系统相仿。其检测方法上与计算 机病毒的检测方式类似。目前基于对包特征描述的模式匹配应用较为广泛。 该方法预报检测的准确 率较高，但对于无经验知识的入侵与攻击行为无能为力。 
2. 统计检测。统计模型常用异常检测，在统计模型中常用的测量参数包括：审计事件的数 量、间隔时间、资源消耗情况等。常用的入侵检测5种统计模型为操作模型、方差、多元模型、马尔 柯夫过程模型和时间序列分析。统计方法的最大优点是它可以"学习"用户的使用习惯，从而具有较高 检出率与可用性。但是它的"学习"能力也给入侵者以机会通过逐步"训练"使入侵事件符合正常操作的 统计规律，从而透过入侵检测系统。 
3. 专家系统。用专家系统对入侵进行检测，经常针对有特征的入侵行为。所谓的规则，即知 识，不同的系统与设置具有不同的规则，且规则之间往往无通用性。专家系统的建立依赖于知识库 的完备性，知识库的完备性又取决于审计记录的完备性与实时性。入侵的特征抽取与表达，是入侵 检测专家系统的关键。运用专家系统防范有特征入侵行为的有效性完全取决于专家系统知识库的完 备性



##### 8-8 病毒和木马扫描

###### 8-8-1 病毒

（1）病毒的概念：病毒是指一段可执行的程序代码，通过对其他程序进行修改来感染这些程序，使其含有该病毒 的一个复制，并且可以在特定的条件下进行破坏

==（2）其整个生命周期中包括潜伏、繁殖（也就是复制、感染阶段）、触发和执行四个阶段==

###### 8-8-2 特洛伊木马（Trojans）

（1）概念：特洛伊木马是指一个正常的文件被修改成包含非法程序的文件。

（2）特点：特洛伊木马通常包含具有管理权限的指令，它们可以隐藏自己的行踪（没有普通的窗口等提示信息），而在后台运 行，并将重要的账号、密码等信息发回给黑客，以便进一步攻击系统。 

（3）组成：木马程序一般由两部分组成，分别是Server（服务）端程序和Client（客户）端程序。

-  Server 端程序安装在被控制计算机上，Client端程序安装在控制计算机上，Server端程序和Client端程序建立起连接就可以实现对远程计算机的控制了。 

- 首先，服务器端程序获得本地计算机的最高操作权限，当本地计算机连入网络后，客户端程序可以与服务器端程序直接建立起连接，并可以向服务器端程序发送各种基本的操作请求，并由服务器端程序完成这些请求，也就实现了对本地计算机的控制。

-  因为木马发挥作用必须要求==服务器端程序和客户端程序同时存在==，所以必须要求本地机器感染服务器端程序，服务器端程序是可执行

  程序，可以直接传播，也可以隐含在其他的可执行程序中传播，==但木马本身不具备繁殖性和自动感染的功能==。

###### 8-8-3 安全扫描 

（1）概念：安全扫描是指对计算机系统及网络端口进行安全性检查，它通常需要借助一个被称为"扫描器"的 软件。扫描器并不是一个直接攻击网络漏洞的程序，它仅仅能够帮助管理员发现目标机的某些内在弱点，一个好的扫描器能够对得到的数据进行分析，帮助管理员查找目标主机的漏洞。它能够自动 查找主机或网络，找到运行的服务及其相关属性，并发现这些服务潜在的漏洞。

（2） 注意：因此从上面的描述中，我们可以发现安全扫描技术是一个帮助管理员找到网络隐患的工具，并 不能直接解决安全问题，而且对未被业界发现的隐患也无法完全找到。





#### 9 网络管理

（1）网络管理具有故障管理、配置管理、计费管理、性能管理和安全管理五大管理功能在网络管理方面,主要考查包括代理服务器、常用的网络命令等。

##### 9-1 代理服务器

（1）概念：代理服务器是介于==浏览器==和==Web服务器==之间的一台服务器，当用户通过代理服务器上网浏览 时，浏览器不是直接到Web服务器去取回网页而是向代理服务器发出请求，由代理服务器来取回浏览器所需要的信息并传送给用户的浏览器。

（2）代理服务器的作用：

- ==提高访问速度==。因为客户要求的数据存于代理服务器的硬盘中，因此下次这个客户或其他 客户再要求相同目的站点的数据时，就会直接从代理服务器的硬盘中读取，代理服务器起到了缓存 的作用，对热门站点有很多客户访问时，代理服务器的优势更为明显。 
- ==可以起到防火墙的作用==。因为所有使用代理服务器的用户都必须通过代理服务器访问远程 站点，因此在代理服务器上就可以设置相应的限制，以过滤或屏蔽掉某些信息。这是局域网网管对 局域网用户访问范围限制最常用的办法，也是局域网用户为什么不能浏览某些网站的原因。拨号用 户如果使用代理服务器，同样必须服从代理服务器的访问限制，除非你不使用这个代理服务器。
- ==通过代理服务器访问一些不能直接访问的网站==。因特网上有许多开放的代理服务器，客户 在访问权限受到限制时，而这些代理服务器的访问权限是不受限制的，刚好代理服务器在客户的访 问范围之内，那么客户通过代理服务器访问目标网站就成为可能。国内的高校多使用教育网，不能 出国，但通过代理服务器，就能实现访问因特网，这就是高校内代理服务器热的原因所在。
- ==安全性得到提高==。无论是上聊天室还是浏览网站，目的网站只能知道用户来自于代理服务 器，而用户的真实IP就无法测知，这就使得用户的安全性得以提高。 
- ==共享IP地址==。由于IP地址比较紧张，通过代理服务器，可以节约一些IP地址。

##### 9-2 网络管理工具

（1）现在网络管理平台有很多，而真正具有OSI定义的网管五大功能的系统却不多，典型的系统包括 ==HP的Open View==、I==BM的Net View和Tivoli==、==SUN的SunNet==、==Cabletron的SPECTRUM==，==Cisco Work==则是最适用于Cisco网络设备密集的网络的实用性网络管理系统。 

（2）在进行网络维护时，我们经常需要监视网络数据流并对其进行分析，这也称为网络监视，而常见的网络监视器包括Ethereal，NetXRay和Sniffer.

Ethereal：提供了对TCP，UDP，SMB，TELNET，FTP等常用协议的支持，覆盖了大部分应用需求 

NetXRay：主要是用做以太网络上的网管软件，能够对IP,NetBEUI,TCP/UDP等协议进行详细分析

Sniffer:它是使网络接口处于混杂模式，以截获网络内容。它是最完善、应用最广泛的一 种网络监视器

（3）网络管理工具： 

- ==ping命令：连通性测试==，基于ICMP协议，用于把一个测试数据包发送到规定的地址，如果一切正常则 返回成功响应，并且可以从时戳中获得链路的状态信息。它常用于以下几个情形： 验证TCP/IP协议是否正常安装：ping 127.0.0.1,如果正常返回，说明安装成功。其中127.0.0.1 是回送地址。 验证IP地址配置是否正常：ping本机IP地址。 查验远程主机：ping远端主机IP地址
- ==tracert：路由追踪==，检查到达的目标 IP 地址的路径并记录结果。tracert 命令显示用于将数据包从计 算机传递到目标位置的一组 IP 路由器，以及每个跃点所需的时间。如果数据包不能传递到目标， tracert 命令将显示成功转发数据包的最后一个路由器。 
- ==netstat：网络情况==，用于显示与IP、TCP、UDP和ICMP协议相关的统计数据，一般用于检验本机各端 口的网络连接情况。
- ==ipconfig：显示当前的TCP/IP配置==。这些信息一般用来检验人工配置的TCP/IP设置是否正确



##### 9-3 开放式网格服务体系

（1）概念：开放式网格服务体系（Open Grid Services Atchitecture,OGSA）被称为是下一代的网格体系 结构，是Web服务（Web Sevices）和网格（Grid）技术结合的产物，提供一组遵守特定的约定并 定义明确的接口，是实体之间产生、管理和交换信息的机制。

##### 9-4 电子政务

（1）电子政务的主要模式有：

- GtoG模式：:政府（Government）之间的电子政务
- GtoE模式：政府（Government）与政府公务员（即政府雇员Employee）之间的电子政务
- GtoB模式：G2B:政府（Government）与企业（Business）之间的电子政务
- GtoC模式：政府（Government）与公民（Citizen）之间的电子政务

##### 9-5 电子商务

（1）概念：电子商务，顾名思义是指在Internet网上进行商务活动。其主要功能包括网上的广告、订货、付 款、客户服务和货物递交等销售、售前和售后服务，以及市场调查分析、财务核计及生产安排等多 项利用Internet开发的商业活动。

（2）模式：

- B2B模式：企业与企业之间
- B2C模式：商家对消费者
- C2C模式：即个人对个人



##### 9-6 VPN虚拟专网

（1）概念：虚拟专用网（Virtual Private Network,VPN）提供了一种通过公用网络安全地对企业内部专用 网络进行远程访问的连接方式。与普通网络连接一样，VPN也由客户机、传输介质和服务器三部分 组成，不同的是VPN连接使用隧道作为传输通道，这个隧道是建立在公共网络或专用网络基础之上的

（2）基本要求

1. 用户验证。VPN方案必须能够验证用户身份并严格控制只有授权用户才能访问VPN，另外，方案还必须能够提供审计和计费功能，显示何人在何时访问了何种信息
2. 地址管理。VPN方案必须能够为用户分配专用网络上的地址并确保地址的安全性
3. 数据加密。对通过公共互联网络传递的数据必须经过加密，确保网络的其他未授权的用户 无法读取该信息
4. 密钥管理。VPN方案必须能够生成并更新客户端和服务器的加密密钥
5. 多协议支持。VPN方案必须支持公共互联网络上普遍使用的基本协议，包括IP,IPX等





##### **知识点**

**知识点一：**

主机路由的子网掩码为：255.255.255.255

默认路由器（第一跳路由）（0.0.0.0）



**知识点二：**

windows中，主机向DNS服务器获取IP地址失败后会自动分配的非正常IP为 169.254.12.42（linux为0.0.0.0）



**知识点三：**

DNS域名解析服务中主机向本地域名服务器的查询采用==递归查询==；

本地域名服务器向根域名服务器的查询采用==迭代查询==



**知识点四：**

数字证书

对网站：

某网站向CA申请了数字证书，用户通过  A  来验证网站的真伪。 

==A、CA的签名== B．证书中的公钥 C．网站的私钥 D．用户的公钥

数字证书是由权威机构——CA证书授权（Certificate Authority）中心发行的，能提供在 Internet上进行身份验证的一种权威性电子文档，人们可以在因特网交往中用它来证明自己的身份和 识别对方的身份。

 数字证书包含版本、序列号、签名算法标识符、签发人姓名、有效期、主体名和主体公钥信息等并附有CA的签名，用户获取网站的数字证书后通过验证==CA的签名==和==确认数字证书的有效性==，从而验证网站的真伪。 

在用户与网站进行安全通信时，用户发送数据时使用网站的公钥（从数字证书中获得）加密， 收到数据时使用网站的公钥验证网站的数字签名，网站利用自身的私钥对发送的消息签名和对收到 的消息解密。

对个人：

用户A从CA处获取了用户B的数字证书，用户A通过  ==CA的公钥==（签名）  可以确认该数字证书的有效性

解析：用户B的数字证书中包含了CA的签名，因此用CA的公钥看验证数字证书的有效性。

**知识点五：**

用户B收到用户A带数字签名的消息M，为了验证M的真实性，首先需要从CA获取用户A的数字证书，并利用__(11)__==验证该证书的真伪==，然后利用__(12)__验证==M的真实性==。

 （11）==A、CA的公钥==   B、B的私钥   C、A的公钥  D、B的公钥

 （12）A、CA的公钥   B、B的私钥   ==C、A的公钥==  D、B的公钥



**知识点六：**

1、数字签名：数字签名可以解决否认、伪造、篡改和冒充的问题（数据的完整性和不可抵赖性）

2、使用非对称加密技术（公钥算法RSA）实现，即：私钥签名，公钥验证

3、作用：

接收者可以验证消息来源的真实性；

发送者无法否认发生过该信息

接受者无法伪造或篡改信息

4、步骤：

生成信息摘要（MD5或SHA算法，保证完整性即防止篡改）→用私钥对信息摘要进行加密（RSA算法，防止抵赖）→接收方用发送方的公钥验证真伪



**知识点七：**

对称加密：DES、3DES、RC-5、IDEA，AES、SHA

RC-5：效率高，大量数据加密

MD5：信息摘要算法

SHA：信息摘要算法



非对称加密：RSA、ECC、PGP

PGP：对邮件加上数字签名从而使收信人可以确信邮件发送者

